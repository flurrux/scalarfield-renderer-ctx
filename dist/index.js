var Ei=Object.create;var ye=Object.defineProperty;var Ui=Object.getOwnPropertyDescriptor;var Fi=Object.getOwnPropertyNames;var qi=Object.getPrototypeOf,Ci=Object.prototype.hasOwnProperty;var wi=t=>ye(t,"__esModule",{value:!0});var w=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Pi=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let u of Fi(e))!Ci.call(t,u)&&(r||u!=="default")&&ye(t,u,{get:()=>e[u],enumerable:!(n=Ui(e,u))||n.enumerable});return t},at=(t,e)=>Pi(wi(ye(t!=null?Ei(qi(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var P=w(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.getEndomorphismMonoid=h.not=h.SK=h.hole=h.pipe=h.untupled=h.tupled=h.absurd=h.decrement=h.increment=h.tuple=h.flow=h.flip=h.constVoid=h.constUndefined=h.constNull=h.constFalse=h.constTrue=h.constant=h.unsafeCoerce=h.identity=h.apply=h.getRing=h.getSemiring=h.getMonoid=h.getSemigroup=h.getBooleanAlgebra=void 0;var Ni=function(t){return function(){return{meet:function(e,r){return function(n){return t.meet(e(n),r(n))}},join:function(e,r){return function(n){return t.join(e(n),r(n))}},zero:function(){return t.zero},one:function(){return t.one},implies:function(e,r){return function(n){return t.implies(e(n),r(n))}},not:function(e){return function(r){return t.not(e(r))}}}}};h.getBooleanAlgebra=Ni;var Li=function(t){return function(){return{concat:function(e,r){return function(n){return t.concat(e(n),r(n))}}}}};h.getSemigroup=Li;var Ti=function(t){var e=h.getSemigroup(t);return function(){return{concat:e().concat,empty:function(){return t.empty}}}};h.getMonoid=Ti;var ji=function(t){return{add:function(e,r){return function(n){return t.add(e(n),r(n))}},zero:function(){return t.zero},mul:function(e,r){return function(n){return t.mul(e(n),r(n))}},one:function(){return t.one}}};h.getSemiring=ji;var zi=function(t){var e=h.getSemiring(t);return{add:e.add,mul:e.mul,one:e.one,zero:e.zero,sub:function(r,n){return function(u){return t.sub(r(u),n(u))}}}};h.getRing=zi;var Bi=function(t){return function(e){return e(t)}};h.apply=Bi;function Ie(t){return t}h.identity=Ie;h.unsafeCoerce=Ie;function Mt(t){return function(){return t}}h.constant=Mt;h.constTrue=Mt(!0);h.constFalse=Mt(!1);h.constNull=Mt(null);h.constUndefined=Mt(void 0);h.constVoid=h.constUndefined;function Di(t){return function(e,r){return t(r,e)}}h.flip=Di;function Nr(t,e,r,n,u,f,l,d,g){switch(arguments.length){case 1:return t;case 2:return function(){return e(t.apply(this,arguments))};case 3:return function(){return r(e(t.apply(this,arguments)))};case 4:return function(){return n(r(e(t.apply(this,arguments))))};case 5:return function(){return u(n(r(e(t.apply(this,arguments)))))};case 6:return function(){return f(u(n(r(e(t.apply(this,arguments))))))};case 7:return function(){return l(f(u(n(r(e(t.apply(this,arguments)))))))};case 8:return function(){return d(l(f(u(n(r(e(t.apply(this,arguments))))))))};case 9:return function(){return g(d(l(f(u(n(r(e(t.apply(this,arguments)))))))))}}}h.flow=Nr;function Hi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t}h.tuple=Hi;function Ki(t){return t+1}h.increment=Ki;function Zi(t){return t-1}h.decrement=Zi;function Lr(t){throw new Error("Called `absurd` function which should be uncallable")}h.absurd=Lr;function Gi(t){return function(e){return t.apply(void 0,e)}}h.tupled=Gi;function Qi(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(e)}}h.untupled=Qi;function Yi(t,e,r,n,u,f,l,d,g){switch(arguments.length){case 1:return t;case 2:return e(t);case 3:return r(e(t));case 4:return n(r(e(t)));case 5:return u(n(r(e(t))));case 6:return f(u(n(r(e(t)))));case 7:return l(f(u(n(r(e(t))))));case 8:return d(l(f(u(n(r(e(t)))))));case 9:return g(d(l(f(u(n(r(e(t))))))));default:for(var y=arguments[0],W=1;W<arguments.length;W++)y=arguments[W](y);return y}}h.pipe=Yi;h.hole=Lr;var $i=function(t,e){return e};h.SK=$i;function Ji(t){return function(e){return!t(e)}}h.not=Ji;var Xi=function(){return{concat:function(t,e){return Nr(t,e)},empty:Ie}};h.getEndomorphismMonoid=Xi});var ct=w(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.sequenceS=T.sequenceT=T.getApplySemigroup=T.apS=T.apSecond=T.apFirst=T.ap=void 0;var so=P();function mo(t,e){return function(r){return function(n){return t.ap(t.map(n,function(u){return function(f){return e.ap(u,f)}}),r)}}}T.ap=mo;function ho(t){return function(e){return function(r){return t.ap(t.map(r,function(n){return function(){return n}}),e)}}}T.apFirst=ho;function vo(t){return function(e){return function(r){return t.ap(t.map(r,function(){return function(n){return n}}),e)}}}T.apSecond=vo;function go(t){return function(e,r){return function(n){return t.ap(t.map(n,function(u){return function(f){var l;return Object.assign({},u,(l={},l[e]=f,l))}}),r)}}}T.apS=go;function yo(t){return function(e){return{concat:function(r,n){return t.ap(t.map(r,function(u){return function(f){return e.concat(u,f)}}),n)}}}}T.getApplySemigroup=yo;function Fe(t,e,r){return function(n){for(var u=Array(r.length+1),f=0;f<r.length;f++)u[f]=r[f];return u[r.length]=n,e===0?t.apply(null,u):Fe(t,e-1,u)}}var qe={1:function(t){return[t]},2:function(t){return function(e){return[t,e]}},3:function(t){return function(e){return function(r){return[t,e,r]}}},4:function(t){return function(e){return function(r){return function(n){return[t,e,r,n]}}}},5:function(t){return function(e){return function(r){return function(n){return function(u){return[t,e,r,n,u]}}}}}};function Io(t){return qe.hasOwnProperty(t)||(qe[t]=Fe(so.tuple,t-1,[])),qe[t]}function xo(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=e.length,u=Io(n),f=t.map(e[0],u),l=1;l<n;l++)f=t.ap(f,e[l]);return f}}T.sequenceT=xo;function Ro(t){var e=t.length;switch(e){case 1:return function(r){var n;return n={},n[t[0]]=r,n};case 2:return function(r){return function(n){var u;return u={},u[t[0]]=r,u[t[1]]=n,u}};case 3:return function(r){return function(n){return function(u){var f;return f={},f[t[0]]=r,f[t[1]]=n,f[t[2]]=u,f}}};case 4:return function(r){return function(n){return function(u){return function(f){var l;return l={},l[t[0]]=r,l[t[1]]=n,l[t[2]]=u,l[t[3]]=f,l}}}};case 5:return function(r){return function(n){return function(u){return function(f){return function(l){var d;return d={},d[t[0]]=r,d[t[1]]=n,d[t[2]]=u,d[t[3]]=f,d[t[4]]=l,d}}}}};default:return Fe(function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(var u={},f=0;f<e;f++)u[t[f]]=r[f];return u},e-1,[])}}function Wo(t){return function(e){for(var r=Object.keys(e),n=r.length,u=Ro(r),f=t.map(e[r[0]],u),l=1;l<n;l++)f=t.ap(f,e[r[l]]);return f}}T.sequenceS=Wo});var vt=w(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.bind=ht.chainFirst=void 0;function Mo(t){return function(e){return function(r){return t.chain(r,function(n){return t.map(e(n),function(){return n})})}}}ht.chainFirst=Mo;function So(t){return function(e,r){return function(n){return t.chain(n,function(u){return t.map(r(u),function(f){var l;return Object.assign({},u,(l={},l[e]=f,l))})})}}}ht.bind=So});var k=w(x=>{"use strict";var bo=x&&x.__spreadArray||function(t,e){for(var r=0,n=e.length,u=t.length;r<n;r++,u++)t[u]=e[r];return t};Object.defineProperty(x,"__esModule",{value:!0});x.fromReadonlyNonEmptyArray=x.has=x.emptyRecord=x.emptyReadonlyArray=x.tail=x.head=x.isNonEmpty=x.singleton=x.right=x.left=x.isRight=x.isLeft=x.some=x.none=x.isSome=x.isNone=void 0;var Ao=function(t){return t._tag==="None"};x.isNone=Ao;var _o=function(t){return t._tag==="Some"};x.isSome=_o;x.none={_tag:"None"};var Vo=function(t){return{_tag:"Some",value:t}};x.some=Vo;var Oo=function(t){return t._tag==="Left"};x.isLeft=Oo;var Eo=function(t){return t._tag==="Right"};x.isRight=Eo;var Uo=function(t){return{_tag:"Left",left:t}};x.left=Uo;var Fo=function(t){return{_tag:"Right",right:t}};x.right=Fo;var qo=function(t){return[t]};x.singleton=qo;var Co=function(t){return t.length>0};x.isNonEmpty=Co;var wo=function(t){return t[0]};x.head=wo;var Po=function(t){return t.slice(1)};x.tail=Po;x.emptyReadonlyArray=[];x.emptyRecord={};x.has=Object.prototype.hasOwnProperty;var No=function(t){return bo([t[0]],t.slice(1))};x.fromReadonlyNonEmptyArray=No});var Zt=w(q=>{"use strict";var Lo=q&&q.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),To=q&&q.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),jo=q&&q.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Lo(e,t,r);return To(e,t),e};Object.defineProperty(q,"__esModule",{value:!0});q.filterOrElse=q.chainEitherK=q.fromEitherK=q.chainOptionK=q.fromOptionK=q.fromPredicate=q.fromOption=void 0;var vn=P(),pt=jo(k());function gn(t){return function(e){return function(r){return t.fromEither(pt.isNone(r)?pt.left(e()):pt.right(r.value))}}}q.fromOption=gn;function zo(t){return function(e,r){return function(n){return t.fromEither(e(n)?pt.right(n):pt.left(r(n)))}}}q.fromPredicate=zo;function yn(t){var e=gn(t);return function(r){var n=e(r);return function(u){return vn.flow(u,n)}}}q.fromOptionK=yn;function Bo(t,e){var r=yn(t);return function(n){var u=r(n);return function(f){return function(l){return e.chain(l,u(f))}}}}q.chainOptionK=Bo;function In(t){return function(e){return vn.flow(e,t.fromEither)}}q.fromEitherK=In;function Do(t,e){var r=In(t);return function(n){return function(u){return e.chain(u,r(n))}}}q.chainEitherK=Do;function Ho(t,e){return function(r,n){return function(u){return e.chain(u,function(f){return t.fromEither(r(f)?pt.right(f):pt.left(n(f)))})}}}q.filterOrElse=Ho});var nt=w($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});$.getFunctorComposition=$.bindTo=$.flap=$.map=void 0;var Ko=P();function xn(t,e){return function(r){return function(n){return t.map(n,function(u){return e.map(u,r)})}}}$.map=xn;function Zo(t){return function(e){return function(r){return t.map(r,function(n){return n(e)})}}}$.flap=Zo;function Go(t){return function(e){return function(r){return t.map(r,function(n){var u;return u={},u[e]=n,u})}}}$.bindTo=Go;function Qo(t,e){var r=xn(t,e);return{map:function(n,u){return Ko.pipe(n,r(u))}}}$.getFunctorComposition=Qo});var Gt=w(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.eqDate=v.eqNumber=v.eqString=v.eqBoolean=v.eq=v.strictEqual=v.getStructEq=v.getTupleEq=v.Contravariant=v.getMonoid=v.getSemigroup=v.eqStrict=v.URI=v.contramap=v.tuple=v.struct=v.fromEquals=void 0;var Yo=P(),$o=function(t){return{equals:function(e,r){return e===r||t(e,r)}}};v.fromEquals=$o;var Jo=function(t){return v.fromEquals(function(e,r){for(var n in t)if(!t[n].equals(e[n],r[n]))return!1;return!0})};v.struct=Jo;var Xo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return v.fromEquals(function(r,n){return t.every(function(u,f){return u.equals(r[f],n[f])})})};v.tuple=Xo;var ko=function(t,e){return Yo.pipe(t,v.contramap(e))},tu=function(t){return function(e){return v.fromEquals(function(r,n){return e.equals(t(r),t(n))})}};v.contramap=tu;v.URI="Eq";v.eqStrict={equals:function(t,e){return t===e}};var eu={equals:function(){return!0}},ru=function(){return{concat:function(t,e){return v.fromEquals(function(r,n){return t.equals(r,n)&&e.equals(r,n)})}}};v.getSemigroup=ru;var nu=function(){return{concat:v.getSemigroup().concat,empty:eu}};v.getMonoid=nu;v.Contravariant={URI:v.URI,contramap:ko};v.getTupleEq=v.tuple;v.getStructEq=v.struct;v.strictEqual=v.eqStrict.equals;v.eq=v.Contravariant;v.eqBoolean=v.eqStrict;v.eqString=v.eqStrict;v.eqNumber=v.eqStrict;v.eqDate={equals:function(t,e){return t.valueOf()===e.valueOf()}}});var _t=w(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.ordDate=s.ordNumber=s.ordString=s.ordBoolean=s.ord=s.getDualOrd=s.getTupleOrd=s.between=s.clamp=s.max=s.min=s.geq=s.leq=s.gt=s.lt=s.equals=s.trivial=s.Contravariant=s.getMonoid=s.getSemigroup=s.URI=s.contramap=s.reverse=s.tuple=s.fromCompare=s.equalsDefault=void 0;var iu=Gt(),Qt=P(),ou=function(t){return function(e,r){return e===r||t(e,r)===0}};s.equalsDefault=ou;var uu=function(t){return{equals:s.equalsDefault(t),compare:function(e,r){return e===r?0:t(e,r)}}};s.fromCompare=uu;var au=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.fromCompare(function(r,n){for(var u=0;u<t.length-1;u++){var f=t[u].compare(r[u],n[u]);if(f!==0)return f}return t[u].compare(r[u],n[u])})};s.tuple=au;var cu=function(t){return s.fromCompare(function(e,r){return t.compare(r,e)})};s.reverse=cu;var pu=function(t,e){return Qt.pipe(t,s.contramap(e))},fu=function(t){return function(e){return s.fromCompare(function(r,n){return e.compare(t(r),t(n))})}};s.contramap=fu;s.URI="Ord";var lu=function(){return{concat:function(t,e){return s.fromCompare(function(r,n){var u=t.compare(r,n);return u!==0?u:e.compare(r,n)})}}};s.getSemigroup=lu;var du=function(){return{concat:s.getSemigroup().concat,empty:s.fromCompare(function(){return 0})}};s.getMonoid=du;s.Contravariant={URI:s.URI,contramap:pu};s.trivial={equals:Qt.constTrue,compare:Qt.constant(0)};var su=function(t){return function(e){return function(r){return r===e||t.compare(r,e)===0}}};s.equals=su;var mu=function(t){return function(e,r){return t.compare(e,r)===-1}};s.lt=mu;var hu=function(t){return function(e,r){return t.compare(e,r)===1}};s.gt=hu;var vu=function(t){return function(e,r){return t.compare(e,r)!==1}};s.leq=vu;var gu=function(t){return function(e,r){return t.compare(e,r)!==-1}};s.geq=gu;var yu=function(t){return function(e,r){return e===r||t.compare(e,r)<1?e:r}};s.min=yu;var Iu=function(t){return function(e,r){return e===r||t.compare(e,r)>-1?e:r}};s.max=Iu;var xu=function(t){var e=s.min(t),r=s.max(t);return function(n,u){return function(f){return r(e(f,u),n)}}};s.clamp=xu;var Ru=function(t){var e=s.lt(t),r=s.gt(t);return function(n,u){return function(f){return!(e(f,n)||r(f,u))}}};s.between=Ru;s.getTupleOrd=s.tuple;s.getDualOrd=s.reverse;s.ord=s.Contravariant;function Wu(t,e){return t<e?-1:t>e?1:0}var Ce={equals:iu.eqStrict.equals,compare:Wu};s.ordBoolean=Ce;s.ordString=Ce;s.ordNumber=Ce;s.ordDate=Qt.pipe(s.ordNumber,s.contramap(function(t){return t.valueOf()}))});var Rn=w(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.concatAll=Z.endo=Z.filterSecond=Z.filterFirst=Z.reverse=void 0;var Mu=function(t){return{concat:function(e,r){return t.concat(r,e)}}};Z.reverse=Mu;var Su=function(t){return function(e){return{concat:function(r,n){return t(r)?e.concat(r,n):n}}}};Z.filterFirst=Su;var bu=function(t){return function(e){return{concat:function(r,n){return t(n)?e.concat(r,n):r}}}};Z.filterSecond=bu;var Au=function(t){return function(e){return{concat:function(r,n){return e.concat(t(r),t(n))}}}};Z.endo=Au;var _u=function(t){return function(e){return function(r){return r.reduce(function(n,u){return t.concat(n,u)},e)}}};Z.concatAll=_u});var Pe=w(m=>{"use strict";var Vu=m&&m.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ou=m&&m.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),we=m&&m.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Vu(e,t,r);return Ou(e,t),e};Object.defineProperty(m,"__esModule",{value:!0});m.semigroupProduct=m.semigroupSum=m.semigroupString=m.getFunctionSemigroup=m.semigroupAny=m.semigroupAll=m.fold=m.getIntercalateSemigroup=m.getMeetSemigroup=m.getJoinSemigroup=m.getDualSemigroup=m.getStructSemigroup=m.getTupleSemigroup=m.getFirstSemigroup=m.getLastSemigroup=m.getObjectSemigroup=m.semigroupVoid=m.concatAll=m.last=m.first=m.intercalate=m.tuple=m.struct=m.reverse=m.constant=m.max=m.min=void 0;var Wn=P(),Eu=we(k()),Mn=we(Rn()),Sn=we(_t()),Uu=function(t){return{concat:Sn.min(t)}};m.min=Uu;var Fu=function(t){return{concat:Sn.max(t)}};m.max=Fu;var qu=function(t){return{concat:function(){return t}}};m.constant=qu;m.reverse=Mn.reverse;var Cu=function(t){return{concat:function(e,r){var n={};for(var u in t)Eu.has.call(t,u)&&(n[u]=t[u].concat(e[u],r[u]));return n}}};m.struct=Cu;var wu=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{concat:function(r,n){return t.map(function(u,f){return u.concat(r[f],n[f])})}}};m.tuple=wu;var Pu=function(t){return function(e){return{concat:function(r,n){return e.concat(r,e.concat(t,n))}}}};m.intercalate=Pu;var Nu=function(){return{concat:Wn.identity}};m.first=Nu;var Lu=function(){return{concat:function(t,e){return e}}};m.last=Lu;m.concatAll=Mn.concatAll;m.semigroupVoid=m.constant(void 0);var Tu=function(){return{concat:function(t,e){return Object.assign({},t,e)}}};m.getObjectSemigroup=Tu;m.getLastSemigroup=m.last;m.getFirstSemigroup=m.first;m.getTupleSemigroup=m.tuple;m.getStructSemigroup=m.struct;m.getDualSemigroup=m.reverse;m.getJoinSemigroup=m.max;m.getMeetSemigroup=m.min;m.getIntercalateSemigroup=m.intercalate;function ju(t){var e=m.concatAll(t);return function(r,n){return n===void 0?e(r):e(r)(n)}}m.fold=ju;m.semigroupAll={concat:function(t,e){return t&&e}};m.semigroupAny={concat:function(t,e){return t||e}};m.getFunctionSemigroup=Wn.getSemigroup;m.semigroupString={concat:function(t,e){return t+e}};m.semigroupSum={concat:function(t,e){return t+e}};m.semigroupProduct={concat:function(t,e){return t*e}}});var He=w(p=>{"use strict";var zu=p&&p.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Bu=p&&p.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),bn=p&&p.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&zu(e,t,r);return Bu(e,t),e},Vt=p&&p.__spreadArray||function(t,e){for(var r=0,n=e.length,u=t.length;r<n;r++,u++)t[u]=e[r];return t};Object.defineProperty(p,"__esModule",{value:!0});p.reduceRight=p.foldMap=p.reduce=p.mapWithIndex=p.map=p.flatten=p.duplicate=p.extend=p.chain=p.ap=p.alt=p.altW=p.of=p.chunksOf=p.splitAt=p.chop=p.chainWithIndex=p.intersperse=p.prependAll=p.unzip=p.zip=p.zipWith=p.modifyAt=p.updateAt=p.sort=p.groupBy=p.group=p.reverse=p.concat=p.concatW=p.fromArray=p.unappend=p.unprepend=p.range=p.replicate=p.makeBy=p.fromReadonlyArray=p.rotate=p.union=p.sortBy=p.uniq=p.unsafeUpdateAt=p.unsafeInsertAt=p.append=p.appendW=p.prepend=p.prependW=p.isOutOfBound=p.isNonEmpty=p.empty=void 0;p.uncons=p.filterWithIndex=p.filter=p.groupSort=p.updateLast=p.modifyLast=p.updateHead=p.modifyHead=p.matchRight=p.matchLeft=p.concatAll=p.max=p.min=p.init=p.last=p.tail=p.head=p.apS=p.bind=p.bindTo=p.Do=p.Comonad=p.Alt=p.TraversableWithIndex=p.Traversable=p.FoldableWithIndex=p.Foldable=p.Monad=p.chainFirst=p.Chain=p.Applicative=p.apSecond=p.apFirst=p.Apply=p.FunctorWithIndex=p.Pointed=p.flap=p.Functor=p.getUnionSemigroup=p.getEq=p.getSemigroup=p.getShow=p.URI=p.extract=p.traverseWithIndex=p.sequence=p.traverse=p.reduceRightWithIndex=p.foldMapWithIndex=p.reduceWithIndex=void 0;p.readonlyNonEmptyArray=p.fold=p.prependToAll=p.insertAt=p.snoc=p.cons=p.unsnoc=void 0;var Ne=ct(),An=vt(),Du=Gt(),V=P(),_n=nt(),j=bn(k()),Hu=_t(),Vn=bn(Pe());p.empty=j.emptyReadonlyArray;p.isNonEmpty=j.isNonEmpty;var Ku=function(t,e){return t<0||t>=e.length};p.isOutOfBound=Ku;var Zu=function(t){return function(e){return Vt([t],e)}};p.prependW=Zu;p.prepend=p.prependW;var Gu=function(t){return function(e){return Vt(Vt([],e),[t])}};p.appendW=Gu;p.append=p.appendW;var Qu=function(t,e,r){if(p.isNonEmpty(r)){var n=j.fromReadonlyNonEmptyArray(r);return n.splice(t,0,e),n}return[e]};p.unsafeInsertAt=Qu;var Yu=function(t,e,r){if(r[t]===e)return r;var n=j.fromReadonlyNonEmptyArray(r);return n[t]=e,n};p.unsafeUpdateAt=Yu;var $u=function(t){return function(e){if(e.length===1)return e;for(var r=[p.head(e)],n=p.tail(e),u=function(g){r.every(function(y){return!t.equals(y,g)})&&r.push(g)},f=0,l=n;f<l.length;f++){var d=l[f];u(d)}return r}};p.uniq=$u;var Ju=function(t){if(p.isNonEmpty(t)){var e=Hu.getMonoid();return p.sort(t.reduce(e.concat,e.empty))}return V.identity};p.sortBy=Ju;var Xu=function(t){var e=p.uniq(t);return function(r){return function(n){return e(V.pipe(n,Ot(r)))}}};p.union=Xu;var ku=function(t){return function(e){var r=e.length,n=Math.round(t)%r;if(p.isOutOfBound(Math.abs(n),e)||n===0)return e;if(n<0){var u=p.splitAt(-n)(e),f=u[0],l=u[1];return V.pipe(l,Ot(f))}else return p.rotate(n-r)(e)}};p.rotate=ku;var ta=function(t){return p.isNonEmpty(t)?j.some(t):j.none};p.fromReadonlyArray=ta;var ea=function(t){return function(e){for(var r=Math.max(0,Math.floor(e)),n=[t(0)],u=1;u<r;u++)n.push(t(u));return n}};p.makeBy=ea;var ra=function(t){return p.makeBy(function(){return t})};p.replicate=ra;var na=function(t,e){return t<=e?p.makeBy(function(r){return t+r})(e-t+1):[t]};p.range=na;var ia=function(t){return[p.head(t),p.tail(t)]};p.unprepend=ia;var oa=function(t){return[p.init(t),p.last(t)]};p.unappend=oa;var ua=function(t){return p.fromReadonlyArray(t.slice())};p.fromArray=ua;function On(t){return function(e){return e.concat(t)}}p.concatW=On;function Ot(t,e){return e?t.concat(e):function(r){return r.concat(t)}}p.concat=Ot;var aa=function(t){return t.length===1?t:Vt([p.last(t)],t.slice(0,-1).reverse())};p.reverse=aa;function En(t){return function(e){var r=e.length;if(r===0)return p.empty;for(var n=[],u=e[0],f=[u],l=1;l<r;l++){var d=e[l];t.equals(d,u)?f.push(d):(n.push(f),u=d,f=[u])}return n.push(f),n}}p.group=En;var ca=function(t){return function(e){for(var r={},n=0,u=e;n<u.length;n++){var f=u[n],l=t(f);r.hasOwnProperty(l)?r[l].push(f):r[l]=[f]}return r}};p.groupBy=ca;var pa=function(t){return function(e){return e.length===1?e:e.slice().sort(t.compare)}};p.sort=pa;var fa=function(t,e){return p.modifyAt(t,function(){return e})};p.updateAt=fa;var la=function(t,e){return function(r){return p.isOutOfBound(t,r)?j.none:j.some(p.unsafeUpdateAt(t,e(r[t]),r))}};p.modifyAt=la;var da=function(t,e,r){for(var n=[r(t[0],e[0])],u=Math.min(t.length,e.length),f=1;f<u;f++)n[f]=r(t[f],e[f]);return n};p.zipWith=da;function Un(t,e){return e===void 0?function(r){return Un(r,t)}:p.zipWith(t,e,function(r,n){return[r,n]})}p.zip=Un;var sa=function(t){for(var e=[t[0][0]],r=[t[0][1]],n=1;n<t.length;n++)e[n]=t[n][0],r[n]=t[n][1];return[e,r]};p.unzip=sa;var ma=function(t){return function(e){for(var r=[t,e[0]],n=1;n<e.length;n++)r.push(t,e[n]);return r}};p.prependAll=ma;var ha=function(t){return function(e){var r=p.tail(e);return p.isNonEmpty(r)?V.pipe(r,p.prependAll(t),p.prepend(p.head(e))):e}};p.intersperse=ha;var va=function(t){return function(e){for(var r=j.fromReadonlyNonEmptyArray(t(0,p.head(e))),n=1;n<e.length;n++)r.push.apply(r,t(n,e[n]));return r}};p.chainWithIndex=va;var ga=function(t){return function(e){for(var r=t(e),n=r[0],u=r[1],f=[n],l=u;p.isNonEmpty(l);){var d=t(l),g=d[0],y=d[1];f.push(g),l=y}return f}};p.chop=ga;var ya=function(t){return function(e){var r=Math.max(1,t);return r>=e.length?[e,p.empty]:[V.pipe(e.slice(1,r),p.prepend(p.head(e))),e.slice(r)]}};p.splitAt=ya;var Ia=function(t){return p.chop(p.splitAt(t))};p.chunksOf=Ia;var G=function(t,e){return V.pipe(t,p.map(e))},Le=function(t,e){return V.pipe(t,p.mapWithIndex(e))},Et=function(t,e){return V.pipe(t,p.ap(e))},Te=function(t,e){return V.pipe(t,p.chain(e))},Fn=function(t,e){return V.pipe(t,p.extend(e))},Ut=function(t,e,r){return V.pipe(t,p.reduce(e,r))},Ft=function(t){var e=p.foldMap(t);return function(r,n){return V.pipe(r,e(n))}},qt=function(t,e,r){return V.pipe(t,p.reduceRight(e,r))},je=function(t){var e=p.traverse(t);return function(r,n){return V.pipe(r,e(n))}},qn=function(t,e){return V.pipe(t,p.alt(e))},ze=function(t,e,r){return V.pipe(t,p.reduceWithIndex(e,r))},Be=function(t){var e=p.foldMapWithIndex(t);return function(r,n){return V.pipe(r,e(n))}},De=function(t,e,r){return V.pipe(t,p.reduceRightWithIndex(e,r))},Cn=function(t){var e=p.traverseWithIndex(t);return function(r,n){return V.pipe(r,e(n))}};p.of=j.singleton;var xa=function(t){return function(e){return V.pipe(e,On(t()))}};p.altW=xa;p.alt=p.altW;var Ra=function(t){return p.chain(function(e){return V.pipe(t,p.map(e))})};p.ap=Ra;var Wa=function(t){return p.chainWithIndex(function(e,r){return t(r)})};p.chain=Wa;var Ma=function(t){return function(e){for(var r=p.tail(e),n=[t(e)];p.isNonEmpty(r);)n.push(t(r)),r=p.tail(r);return n}};p.extend=Ma;p.duplicate=p.extend(V.identity);p.flatten=p.chain(V.identity);var Sa=function(t){return p.mapWithIndex(function(e,r){return t(r)})};p.map=Sa;var ba=function(t){return function(e){for(var r=[t(0,p.head(e))],n=1;n<e.length;n++)r.push(t(n,e[n]));return r}};p.mapWithIndex=ba;var Aa=function(t,e){return p.reduceWithIndex(t,function(r,n,u){return e(n,u)})};p.reduce=Aa;var _a=function(t){return function(e){return function(r){return r.slice(1).reduce(function(n,u){return t.concat(n,e(u))},e(r[0]))}}};p.foldMap=_a;var Va=function(t,e){return p.reduceRightWithIndex(t,function(r,n,u){return e(n,u)})};p.reduceRight=Va;var Oa=function(t,e){return function(r){return r.reduce(function(n,u,f){return e(f,n,u)},t)}};p.reduceWithIndex=Oa;var Ea=function(t){return function(e){return function(r){return r.slice(1).reduce(function(n,u,f){return t.concat(n,e(f+1,u))},e(0,r[0]))}}};p.foldMapWithIndex=Ea;var Ua=function(t,e){return function(r){return r.reduceRight(function(n,u,f){return e(f,u,n)},t)}};p.reduceRightWithIndex=Ua;var Fa=function(t){var e=p.traverseWithIndex(t);return function(r){return e(function(n,u){return r(u)})}};p.traverse=Fa;var qa=function(t){return p.traverseWithIndex(t)(V.SK)};p.sequence=qa;var Ca=function(t){return function(e){return function(r){for(var n=t.map(e(0,p.head(r)),p.of),u=1;u<r.length;u++)n=t.ap(t.map(n,function(f){return function(l){return V.pipe(f,p.append(l))}}),e(u,r[u]));return n}}};p.traverseWithIndex=Ca;p.extract=j.head;p.URI="ReadonlyNonEmptyArray";var wa=function(t){return{show:function(e){return"["+e.map(t.show).join(", ")+"]"}}};p.getShow=wa;var Pa=function(){return{concat:Ot}};p.getSemigroup=Pa;var Na=function(t){return Du.fromEquals(function(e,r){return e.length===r.length&&e.every(function(n,u){return t.equals(n,r[u])})})};p.getEq=Na;var La=function(t){var e=p.union(t);return{concat:function(r,n){return e(n)(r)}}};p.getUnionSemigroup=La;p.Functor={URI:p.URI,map:G};p.flap=_n.flap(p.Functor);p.Pointed={URI:p.URI,of:p.of};p.FunctorWithIndex={URI:p.URI,map:G,mapWithIndex:Le};p.Apply={URI:p.URI,map:G,ap:Et};p.apFirst=Ne.apFirst(p.Apply);p.apSecond=Ne.apSecond(p.Apply);p.Applicative={URI:p.URI,map:G,ap:Et,of:p.of};p.Chain={URI:p.URI,map:G,ap:Et,chain:Te};p.chainFirst=An.chainFirst(p.Chain);p.Monad={URI:p.URI,map:G,ap:Et,of:p.of,chain:Te};p.Foldable={URI:p.URI,reduce:Ut,foldMap:Ft,reduceRight:qt};p.FoldableWithIndex={URI:p.URI,reduce:Ut,foldMap:Ft,reduceRight:qt,reduceWithIndex:ze,foldMapWithIndex:Be,reduceRightWithIndex:De};p.Traversable={URI:p.URI,map:G,reduce:Ut,foldMap:Ft,reduceRight:qt,traverse:je,sequence:p.sequence};p.TraversableWithIndex={URI:p.URI,map:G,mapWithIndex:Le,reduce:Ut,foldMap:Ft,reduceRight:qt,traverse:je,sequence:p.sequence,reduceWithIndex:ze,foldMapWithIndex:Be,reduceRightWithIndex:De,traverseWithIndex:Cn};p.Alt={URI:p.URI,map:G,alt:qn};p.Comonad={URI:p.URI,map:G,extend:Fn,extract:p.extract};p.Do=p.of(j.emptyRecord);p.bindTo=_n.bindTo(p.Functor);p.bind=An.bind(p.Chain);p.apS=Ne.apS(p.Apply);p.head=p.extract;p.tail=j.tail;var Ta=function(t){return t[t.length-1]};p.last=Ta;var ja=function(t){return t.slice(0,-1)};p.init=ja;var za=function(t){var e=Vn.min(t);return function(r){return r.reduce(e.concat)}};p.min=za;var Ba=function(t){var e=Vn.max(t);return function(r){return r.reduce(e.concat)}};p.max=Ba;var Da=function(t){return function(e){return e.reduce(t.concat)}};p.concatAll=Da;var Ha=function(t){return function(e){return t(p.head(e),p.tail(e))}};p.matchLeft=Ha;var Ka=function(t){return function(e){return t(p.init(e),p.last(e))}};p.matchRight=Ka;var Za=function(t){return function(e){return Vt([t(p.head(e))],p.tail(e))}};p.modifyHead=Za;var Ga=function(t){return p.modifyHead(function(){return t})};p.updateHead=Ga;var Qa=function(t){return function(e){return V.pipe(p.init(e),p.append(t(p.last(e))))}};p.modifyLast=Qa;var Ya=function(t){return p.modifyLast(function(){return t})};p.updateLast=Ya;function $a(t){var e=p.sort(t),r=En(t);return function(n){return p.isNonEmpty(n)?r(e(n)):p.empty}}p.groupSort=$a;function Ja(t){return p.filterWithIndex(function(e,r){return t(r)})}p.filter=Ja;var Xa=function(t){return function(e){return p.fromReadonlyArray(e.filter(function(r,n){return t(n,r)}))}};p.filterWithIndex=Xa;p.uncons=p.unprepend;p.unsnoc=p.unappend;function ka(t,e){return e===void 0?p.prepend(t):V.pipe(e,p.prepend(t))}p.cons=ka;var tc=function(t,e){return V.pipe(t,Ot([e]))};p.snoc=tc;var ec=function(t,e){return function(r){return t<0||t>r.length?j.none:j.some(p.unsafeInsertAt(t,e,r))}};p.insertAt=ec;p.prependToAll=p.prependAll;p.fold=p.concatAll;p.readonlyNonEmptyArray={URI:p.URI,of:p.of,map:G,mapWithIndex:Le,ap:Et,chain:Te,extend:Fn,extract:p.extract,reduce:Ut,foldMap:Ft,reduceRight:qt,traverse:je,sequence:p.sequence,reduceWithIndex:ze,foldMapWithIndex:Be,reduceRightWithIndex:De,traverseWithIndex:Cn,alt:qn}});var Hn=w(c=>{"use strict";var rc=c&&c.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),nc=c&&c.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),wn=c&&c.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&rc(e,t,r);return nc(e,t),e},Ct=c&&c.__spreadArray||function(t,e){for(var r=0,n=e.length,u=t.length;r<n;r++,u++)t[u]=e[r];return t};Object.defineProperty(c,"__esModule",{value:!0});c.mapWithIndex=c.map=c.flatten=c.duplicate=c.extend=c.chain=c.ap=c.alt=c.altW=c.chunksOf=c.splitAt=c.chop=c.chainWithIndex=c.foldMap=c.foldMapWithIndex=c.intersperse=c.prependAll=c.unzip=c.zip=c.zipWith=c.of=c.copy=c.modifyAt=c.updateAt=c.insertAt=c.sort=c.groupBy=c.group=c.reverse=c.concat=c.concatW=c.unappend=c.unprepend=c.range=c.replicate=c.makeBy=c.fromArray=c.fromReadonlyNonEmptyArray=c.rotate=c.union=c.sortBy=c.uniq=c.unsafeUpdateAt=c.unsafeInsertAt=c.append=c.appendW=c.prepend=c.prependW=c.isOutOfBound=c.isNonEmpty=void 0;c.filterWithIndex=c.filter=c.groupSort=c.updateLast=c.modifyLast=c.updateHead=c.modifyHead=c.matchRight=c.matchLeft=c.concatAll=c.max=c.min=c.init=c.last=c.tail=c.head=c.apS=c.bind=c.bindTo=c.Do=c.Comonad=c.Alt=c.TraversableWithIndex=c.Traversable=c.FoldableWithIndex=c.Foldable=c.Monad=c.chainFirst=c.Chain=c.Applicative=c.apSecond=c.apFirst=c.Apply=c.FunctorWithIndex=c.Pointed=c.flap=c.Functor=c.getUnionSemigroup=c.getEq=c.getSemigroup=c.getShow=c.URI=c.extract=c.traverseWithIndex=c.sequence=c.traverse=c.reduceRightWithIndex=c.reduceRight=c.reduceWithIndex=c.reduce=void 0;c.nonEmptyArray=c.fold=c.prependToAll=c.snoc=c.cons=c.unsnoc=c.uncons=void 0;var Ke=ct(),Pn=vt(),E=P(),Nn=nt(),it=wn(k()),ic=_t(),B=wn(He()),oc=function(t){return t.length>0};c.isNonEmpty=oc;var uc=function(t,e){return t<0||t>=e.length};c.isOutOfBound=uc;var ac=function(t){return function(e){return Ct([t],e)}};c.prependW=ac;c.prepend=c.prependW;var cc=function(t){return function(e){return Ct(Ct([],e),[t])}};c.appendW=cc;c.append=c.appendW;var pc=function(t,e,r){if(c.isNonEmpty(r)){var n=c.fromReadonlyNonEmptyArray(r);return n.splice(t,0,e),n}return[e]};c.unsafeInsertAt=pc;var fc=function(t,e,r){var n=c.fromReadonlyNonEmptyArray(r);return n[t]=e,n};c.unsafeUpdateAt=fc;var lc=function(t){return function(e){if(e.length===1)return c.copy(e);for(var r=[c.head(e)],n=c.tail(e),u=function(g){r.every(function(y){return!t.equals(y,g)})&&r.push(g)},f=0,l=n;f<l.length;f++){var d=l[f];u(d)}return r}};c.uniq=lc;var dc=function(t){if(c.isNonEmpty(t)){var e=ic.getMonoid();return c.sort(t.reduce(e.concat,e.empty))}return c.copy};c.sortBy=dc;var sc=function(t){var e=c.uniq(t);return function(r){return function(n){return e(E.pipe(n,Yt(r)))}}};c.union=sc;var mc=function(t){return function(e){var r=e.length,n=Math.round(t)%r;if(c.isOutOfBound(Math.abs(n),e)||n===0)return c.copy(e);if(n<0){var u=c.splitAt(-n)(e),f=u[0],l=u[1];return E.pipe(l,Yt(f))}else return c.rotate(n-r)(e)}};c.rotate=mc;c.fromReadonlyNonEmptyArray=it.fromReadonlyNonEmptyArray;var hc=function(t){return c.isNonEmpty(t)?it.some(t):it.none};c.fromArray=hc;var vc=function(t){return function(e){for(var r=Math.max(0,Math.floor(e)),n=[t(0)],u=1;u<r;u++)n.push(t(u));return n}};c.makeBy=vc;var gc=function(t){return c.makeBy(function(){return t})};c.replicate=gc;var yc=function(t,e){return t<=e?c.makeBy(function(r){return t+r})(e-t+1):[t]};c.range=yc;var Ic=function(t){return[c.head(t),c.tail(t)]};c.unprepend=Ic;var xc=function(t){return[c.init(t),c.last(t)]};c.unappend=xc;function Ln(t){return function(e){return e.concat(t)}}c.concatW=Ln;function Yt(t,e){return e?t.concat(e):function(r){return r.concat(t)}}c.concat=Yt;var Rc=function(t){return Ct([c.last(t)],t.slice(0,-1).reverse())};c.reverse=Rc;function Tn(t){return function(e){var r=e.length;if(r===0)return[];for(var n=[],u=e[0],f=[u],l=1;l<r;l++){var d=e[l];t.equals(d,u)?f.push(d):(n.push(f),u=d,f=[u])}return n.push(f),n}}c.group=Tn;var Wc=function(t){return function(e){for(var r={},n=0,u=e;n<u.length;n++){var f=u[n],l=t(f);r.hasOwnProperty(l)?r[l].push(f):r[l]=[f]}return r}};c.groupBy=Wc;var Mc=function(t){return function(e){return e.slice().sort(t.compare)}};c.sort=Mc;var Sc=function(t,e){return function(r){return t<0||t>r.length?it.none:it.some(c.unsafeInsertAt(t,e,r))}};c.insertAt=Sc;var bc=function(t,e){return c.modifyAt(t,function(){return e})};c.updateAt=bc;var Ac=function(t,e){return function(r){return c.isOutOfBound(t,r)?it.none:it.some(c.unsafeUpdateAt(t,e(r[t]),r))}};c.modifyAt=Ac;c.copy=c.fromReadonlyNonEmptyArray;var _c=function(t){return[t]};c.of=_c;var Vc=function(t,e,r){for(var n=[r(t[0],e[0])],u=Math.min(t.length,e.length),f=1;f<u;f++)n[f]=r(t[f],e[f]);return n};c.zipWith=Vc;function jn(t,e){return e===void 0?function(r){return jn(r,t)}:c.zipWith(t,e,function(r,n){return[r,n]})}c.zip=jn;var Oc=function(t){for(var e=[t[0][0]],r=[t[0][1]],n=1;n<t.length;n++)e[n]=t[n][0],r[n]=t[n][1];return[e,r]};c.unzip=Oc;var Ec=function(t){return function(e){for(var r=[t,e[0]],n=1;n<e.length;n++)r.push(t,e[n]);return r}};c.prependAll=Ec;var Uc=function(t){return function(e){var r=c.tail(e);return c.isNonEmpty(r)?E.pipe(r,c.prependAll(t),c.prepend(c.head(e))):c.copy(e)}};c.intersperse=Uc;c.foldMapWithIndex=B.foldMapWithIndex;c.foldMap=B.foldMap;var Fc=function(t){return function(e){for(var r=c.fromReadonlyNonEmptyArray(t(0,c.head(e))),n=1;n<e.length;n++)r.push.apply(r,t(n,e[n]));return r}};c.chainWithIndex=Fc;var qc=function(t){return function(e){for(var r=t(e),n=r[0],u=r[1],f=[n],l=u;c.isNonEmpty(l);){var d=t(l),g=d[0],y=d[1];f.push(g),l=y}return f}};c.chop=qc;var Cc=function(t){return function(e){var r=Math.max(1,t);return r>=e.length?[c.copy(e),[]]:[E.pipe(e.slice(1,r),c.prepend(c.head(e))),e.slice(r)]}};c.splitAt=Cc;var wc=function(t){return c.chop(c.splitAt(t))};c.chunksOf=wc;var Q=function(t,e){return E.pipe(t,c.map(e))},Ze=function(t,e){return E.pipe(t,c.mapWithIndex(e))},wt=function(t,e){return E.pipe(t,c.ap(e))},Ge=function(t,e){return E.pipe(t,c.chain(e))},zn=function(t,e){return E.pipe(t,c.extend(e))},Pt=function(t,e,r){return E.pipe(t,c.reduce(e,r))},Nt=function(t){var e=c.foldMap(t);return function(r,n){return E.pipe(r,e(n))}},Lt=function(t,e,r){return E.pipe(t,c.reduceRight(e,r))},Qe=function(t){var e=c.traverse(t);return function(r,n){return E.pipe(r,e(n))}},Bn=function(t,e){return E.pipe(t,c.alt(e))},Ye=function(t,e,r){return E.pipe(t,c.reduceWithIndex(e,r))},$e=function(t){var e=c.foldMapWithIndex(t);return function(r,n){return E.pipe(r,e(n))}},Je=function(t,e,r){return E.pipe(t,c.reduceRightWithIndex(e,r))},Dn=function(t){var e=c.traverseWithIndex(t);return function(r,n){return E.pipe(r,e(n))}},Pc=function(t){return function(e){return E.pipe(e,Ln(t()))}};c.altW=Pc;c.alt=c.altW;var Nc=function(t){return c.chain(function(e){return E.pipe(t,c.map(e))})};c.ap=Nc;var Lc=function(t){return c.chainWithIndex(function(e,r){return t(r)})};c.chain=Lc;var Tc=function(t){return function(e){for(var r=c.tail(e),n=[t(e)];c.isNonEmpty(r);)n.push(t(r)),r=c.tail(r);return n}};c.extend=Tc;c.duplicate=c.extend(E.identity);c.flatten=c.chain(E.identity);var jc=function(t){return c.mapWithIndex(function(e,r){return t(r)})};c.map=jc;var zc=function(t){return function(e){for(var r=[t(0,c.head(e))],n=1;n<e.length;n++)r.push(t(n,e[n]));return r}};c.mapWithIndex=zc;c.reduce=B.reduce;c.reduceWithIndex=B.reduceWithIndex;c.reduceRight=B.reduceRight;c.reduceRightWithIndex=B.reduceRightWithIndex;var Bc=function(t){var e=c.traverseWithIndex(t);return function(r){return e(function(n,u){return r(u)})}};c.traverse=Bc;var Dc=function(t){return c.traverseWithIndex(t)(function(e,r){return r})};c.sequence=Dc;var Hc=function(t){return function(e){return function(r){for(var n=t.map(e(0,c.head(r)),c.of),u=1;u<r.length;u++)n=t.ap(t.map(n,function(f){return function(l){return E.pipe(f,c.append(l))}}),e(u,r[u]));return n}}};c.traverseWithIndex=Hc;c.extract=B.head;c.URI="NonEmptyArray";c.getShow=B.getShow;var Kc=function(){return{concat:Yt}};c.getSemigroup=Kc;c.getEq=B.getEq;var Zc=function(t){var e=c.union(t);return{concat:function(r,n){return e(n)(r)}}};c.getUnionSemigroup=Zc;c.Functor={URI:c.URI,map:Q};c.flap=Nn.flap(c.Functor);c.Pointed={URI:c.URI,of:c.of};c.FunctorWithIndex={URI:c.URI,map:Q,mapWithIndex:Ze};c.Apply={URI:c.URI,map:Q,ap:wt};c.apFirst=Ke.apFirst(c.Apply);c.apSecond=Ke.apSecond(c.Apply);c.Applicative={URI:c.URI,map:Q,ap:wt,of:c.of};c.Chain={URI:c.URI,map:Q,ap:wt,chain:Ge};c.chainFirst=Pn.chainFirst(c.Chain);c.Monad={URI:c.URI,map:Q,ap:wt,of:c.of,chain:Ge};c.Foldable={URI:c.URI,reduce:Pt,foldMap:Nt,reduceRight:Lt};c.FoldableWithIndex={URI:c.URI,reduce:Pt,foldMap:Nt,reduceRight:Lt,reduceWithIndex:Ye,foldMapWithIndex:$e,reduceRightWithIndex:Je};c.Traversable={URI:c.URI,map:Q,reduce:Pt,foldMap:Nt,reduceRight:Lt,traverse:Qe,sequence:c.sequence};c.TraversableWithIndex={URI:c.URI,map:Q,mapWithIndex:Ze,reduce:Pt,foldMap:Nt,reduceRight:Lt,traverse:Qe,sequence:c.sequence,reduceWithIndex:Ye,foldMapWithIndex:$e,reduceRightWithIndex:Je,traverseWithIndex:Dn};c.Alt={URI:c.URI,map:Q,alt:Bn};c.Comonad={URI:c.URI,map:Q,extend:zn,extract:c.extract};c.Do=c.of(it.emptyRecord);c.bindTo=Nn.bindTo(c.Functor);c.bind=Pn.bind(c.Chain);c.apS=Ke.apS(c.Apply);c.head=B.head;var Gc=function(t){return t.slice(1)};c.tail=Gc;c.last=B.last;var Qc=function(t){return t.slice(0,-1)};c.init=Qc;c.min=B.min;c.max=B.max;var Yc=function(t){return function(e){return e.reduce(t.concat)}};c.concatAll=Yc;var $c=function(t){return function(e){return t(c.head(e),c.tail(e))}};c.matchLeft=$c;var Jc=function(t){return function(e){return t(c.init(e),c.last(e))}};c.matchRight=Jc;var Xc=function(t){return function(e){return Ct([t(c.head(e))],c.tail(e))}};c.modifyHead=Xc;var kc=function(t){return c.modifyHead(function(){return t})};c.updateHead=kc;var tp=function(t){return function(e){return E.pipe(c.init(e),c.append(t(c.last(e))))}};c.modifyLast=tp;var ep=function(t){return c.modifyLast(function(){return t})};c.updateLast=ep;function rp(t){var e=c.sort(t),r=Tn(t);return function(n){return c.isNonEmpty(n)?r(e(n)):[]}}c.groupSort=rp;function np(t){return c.filterWithIndex(function(e,r){return t(r)})}c.filter=np;var ip=function(t){return function(e){return c.fromArray(e.filter(function(r,n){return t(n,r)}))}};c.filterWithIndex=ip;c.uncons=c.unprepend;c.unsnoc=c.unappend;function op(t,e){return e===void 0?c.prepend(t):E.pipe(e,c.prepend(t))}c.cons=op;var up=function(t,e){return E.pipe(t,c.append(e))};c.snoc=up;c.prependToAll=c.prependAll;c.fold=B.concatAll;c.nonEmptyArray={URI:c.URI,of:c.of,map:Q,mapWithIndex:Ze,ap:wt,chain:Ge,extend:zn,extract:c.extract,reduce:Pt,foldMap:Nt,reduceRight:Lt,traverse:Qe,sequence:c.sequence,reduceWithIndex:Ye,foldMapWithIndex:$e,reduceRightWithIndex:Je,traverseWithIndex:Dn,alt:Bn}});var Xe=w(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.Field=b.MonoidProduct=b.MonoidSum=b.SemigroupProduct=b.SemigroupSum=b.MagmaSub=b.Show=b.Bounded=b.Ord=b.Eq=b.isNumber=void 0;var ap=function(t){return typeof t=="number"};b.isNumber=ap;b.Eq={equals:function(t,e){return t===e}};b.Ord={equals:b.Eq.equals,compare:function(t,e){return t<e?-1:t>e?1:0}};b.Bounded={equals:b.Eq.equals,compare:b.Ord.compare,top:1/0,bottom:-1/0};b.Show={show:function(t){return JSON.stringify(t)}};b.MagmaSub={concat:function(t,e){return t-e}};b.SemigroupSum={concat:function(t,e){return t+e}};b.SemigroupProduct={concat:function(t,e){return t*e}};b.MonoidSum={concat:b.SemigroupSum.concat,empty:0};b.MonoidProduct={concat:b.SemigroupProduct.concat,empty:1};b.Field={add:b.SemigroupSum.concat,zero:0,mul:b.SemigroupProduct.concat,one:1,sub:b.MagmaSub.concat,degree:function(t){return 1},div:function(t,e){return t/e},mod:function(t,e){return t%e}}});var $t=w(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.right=I.left=I.flap=I.Functor=I.Bifunctor=I.URI=I.bimap=I.mapLeft=I.map=I.separated=void 0;var ke=P(),cp=nt(),pp=function(t,e){return{left:t,right:e}};I.separated=pp;var fp=function(t,e){return ke.pipe(t,I.map(e))},lp=function(t,e){return ke.pipe(t,I.mapLeft(e))},dp=function(t,e,r){return ke.pipe(t,I.bimap(e,r))},sp=function(t){return function(e){return I.separated(I.left(e),t(I.right(e)))}};I.map=sp;var mp=function(t){return function(e){return I.separated(t(I.left(e)),I.right(e))}};I.mapLeft=mp;var hp=function(t,e){return function(r){return I.separated(t(I.left(r)),e(I.right(r)))}};I.bimap=hp;I.URI="Separated";I.Bifunctor={URI:I.URI,mapLeft:lp,bimap:dp};I.Functor={URI:I.URI,map:fp};I.flap=cp.flap(I.Functor);var vp=function(t){return t.left};I.left=vp;var gp=function(t){return t.right};I.right=gp});var Jt=w(D=>{"use strict";var yp=D&&D.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ip=D&&D.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),xp=D&&D.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&yp(e,t,r);return Ip(e,t),e};Object.defineProperty(D,"__esModule",{value:!0});D.filterE=D.witherDefault=D.wiltDefault=void 0;var Kn=xp(k());function Rp(t,e){return function(r){var n=t.traverse(r);return function(u,f){return r.map(n(u,f),e.separate)}}}D.wiltDefault=Rp;function Wp(t,e){return function(r){var n=t.traverse(r);return function(u,f){return r.map(n(u,f),e.compact)}}}D.witherDefault=Wp;function Mp(t){return function(e){var r=t.wither(e);return function(n){return function(u){return r(u,function(f){return e.map(n(f),function(l){return l?Kn.some(f):Kn.none})})}}}}D.filterE=Mp});var kt=w(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.guard=void 0;function Sp(t,e){return function(r){return r?e.of(void 0):t.zero()}}Xt.guard=Sp});var ni=w(i=>{"use strict";var bp=i&&i.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ap=i&&i.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),tr=i&&i.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bp(e,t,r);return Ap(e,t),e},_p=i&&i.__spreadArray||function(t,e){for(var r=0,n=e.length,u=t.length;r<n;r++,u++)t[u]=e[r];return t};Object.defineProperty(i,"__esModule",{value:!0});i.sort=i.lefts=i.rights=i.reverse=i.modifyAt=i.deleteAt=i.updateAt=i.insertAt=i.findLastIndex=i.findLastMap=i.findLast=i.findFirstMap=i.findFirst=i.findIndex=i.dropLeftWhile=i.dropRight=i.dropLeft=i.spanLeft=i.takeLeftWhile=i.takeRight=i.takeLeft=i.init=i.tail=i.last=i.head=i.lookup=i.isOutOfBound=i.size=i.scanRight=i.scanLeft=i.chainWithIndex=i.foldRight=i.matchRight=i.matchRightW=i.foldLeft=i.matchLeft=i.matchLeftW=i.match=i.matchW=i.fromEither=i.fromOption=i.fromPredicate=i.replicate=i.makeBy=i.appendW=i.append=i.prependW=i.prepend=i.isNonEmpty=i.isEmpty=void 0;i.sequence=i.traverse=i.reduceRightWithIndex=i.reduceRight=i.reduceWithIndex=i.foldMap=i.reduce=i.foldMapWithIndex=i.duplicate=i.extend=i.filterWithIndex=i.partitionMapWithIndex=i.partitionMap=i.partitionWithIndex=i.partition=i.compact=i.filterMap=i.filterMapWithIndex=i.filter=i.separate=i.mapWithIndex=i.map=i.flatten=i.chain=i.ap=i.alt=i.altW=i.zero=i.of=i._chainRecBreadthFirst=i._chainRecDepthFirst=i.difference=i.intersection=i.union=i.concat=i.concatW=i.comprehension=i.fromOptionK=i.chunksOf=i.splitAt=i.chop=i.sortBy=i.uniq=i.elem=i.rotate=i.intersperse=i.prependAll=i.unzip=i.zip=i.zipWith=void 0;i.toArray=i.unsafeDeleteAt=i.unsafeUpdateAt=i.unsafeInsertAt=i.fromEitherK=i.FromEither=i.filterE=i.Witherable=i.ChainRecBreadthFirst=i.chainRecBreadthFirst=i.ChainRecDepthFirst=i.chainRecDepthFirst=i.TraversableWithIndex=i.Traversable=i.FoldableWithIndex=i.Foldable=i.FilterableWithIndex=i.Filterable=i.Compactable=i.Extend=i.Alternative=i.guard=i.Zero=i.Alt=i.Unfoldable=i.chainFirst=i.Monad=i.Chain=i.Applicative=i.apSecond=i.apFirst=i.Apply=i.FunctorWithIndex=i.Pointed=i.flap=i.Functor=i.getDifferenceMagma=i.getIntersectionSemigroup=i.getUnionMonoid=i.getUnionSemigroup=i.getOrd=i.getEq=i.getMonoid=i.getSemigroup=i.getShow=i.URI=i.unfold=i.wilt=i.wither=i.traverseWithIndex=void 0;i.readonlyArray=i.prependToAll=i.snoc=i.cons=i.range=i.apS=i.bind=i.bindTo=i.Do=i.exists=i.some=i.every=i.empty=i.fromArray=void 0;var er=ct(),Zn=vt(),Vp=Gt(),Op=Zt(),S=P(),Gn=nt(),R=tr(k()),Ep=tr(Xe()),Up=_t(),M=tr(He()),rr=$t(),nr=Jt(),Fp=kt(),qp=function(t){return t.length===0};i.isEmpty=qp;i.isNonEmpty=M.isNonEmpty;i.prepend=M.prepend;i.prependW=M.prependW;i.append=M.append;i.appendW=M.appendW;var Cp=function(t,e){return t<=0?i.empty:M.makeBy(e)(t)};i.makeBy=Cp;var wp=function(t,e){return i.makeBy(t,function(){return e})};i.replicate=wp;function Pp(t){return function(e){return t(e)?[e]:i.empty}}i.fromPredicate=Pp;var Np=function(t){return R.isNone(t)?i.empty:[t.value]};i.fromOption=Np;var Lp=function(t){return R.isLeft(t)?i.empty:[t.right]};i.fromEither=Lp;var Tp=function(t,e){return function(r){return i.isNonEmpty(r)?e(r):t()}};i.matchW=Tp;i.match=i.matchW;var jp=function(t,e){return function(r){return i.isNonEmpty(r)?e(M.head(r),M.tail(r)):t()}};i.matchLeftW=jp;i.matchLeft=i.matchLeftW;i.foldLeft=i.matchLeft;var zp=function(t,e){return function(r){return i.isNonEmpty(r)?e(M.init(r),M.last(r)):t()}};i.matchRightW=zp;i.matchRight=i.matchRightW;i.foldRight=i.matchRight;var Bp=function(t){return function(e){if(i.isEmpty(e))return i.empty;for(var r=[],n=0;n<e.length;n++)r.push.apply(r,t(n,e[n]));return r}};i.chainWithIndex=Bp;var Dp=function(t,e){return function(r){var n=r.length,u=new Array(n+1);u[0]=t;for(var f=0;f<n;f++)u[f+1]=e(u[f],r[f]);return u}};i.scanLeft=Dp;var Hp=function(t,e){return function(r){var n=r.length,u=new Array(n+1);u[n]=t;for(var f=n-1;f>=0;f--)u[f]=e(r[f],u[f+1]);return u}};i.scanRight=Hp;var Kp=function(t){return t.length};i.size=Kp;i.isOutOfBound=M.isOutOfBound;function Qn(t,e){return e===void 0?function(r){return Qn(t,r)}:i.isOutOfBound(t,e)?R.none:R.some(e[t])}i.lookup=Qn;var Zp=function(t){return i.isNonEmpty(t)?R.some(M.head(t)):R.none};i.head=Zp;var Gp=function(t){return i.isNonEmpty(t)?R.some(M.last(t)):R.none};i.last=Gp;var Qp=function(t){return i.isNonEmpty(t)?R.some(M.tail(t)):R.none};i.tail=Qp;var Yp=function(t){return i.isNonEmpty(t)?R.some(M.init(t)):R.none};i.init=Yp;var $p=function(t){return function(e){return i.isOutOfBound(t,e)?e:t===0?i.empty:e.slice(0,t)}};i.takeLeft=$p;var Jp=function(t){return function(e){return i.isOutOfBound(t,e)?e:t===0?i.empty:e.slice(-t)}};i.takeRight=Jp;function Xp(t){return function(e){for(var r=[],n=0,u=e;n<u.length;n++){var f=u[n];if(!t(f))break;r.push(f)}var l=r.length;return l===e.length?e:l===0?i.empty:r}}i.takeLeftWhile=Xp;var Yn=function(t,e){for(var r=t.length,n=0;n<r&&e(t[n]);n++);return n};function kp(t){return function(e){var r=i.splitAt(Yn(e,t))(e),n=r[0],u=r[1];return{init:n,rest:u}}}i.spanLeft=kp;var tf=function(t){return function(e){return t<=0||i.isEmpty(e)?e:t>=e.length?i.empty:e.slice(t,e.length)}};i.dropLeft=tf;var ef=function(t){return function(e){return t<=0||i.isEmpty(e)?e:t>=e.length?i.empty:e.slice(0,e.length-t)}};i.dropRight=ef;function rf(t){return function(e){var r=Yn(e,t);return r===0?e:r===e.length?i.empty:e.slice(r)}}i.dropLeftWhile=rf;var nf=function(t){return function(e){for(var r=0;r<e.length;r++)if(t(e[r]))return R.some(r);return R.none}};i.findIndex=nf;function of(t){return function(e){for(var r=0;r<e.length;r++)if(t(e[r]))return R.some(e[r]);return R.none}}i.findFirst=of;var uf=function(t){return function(e){for(var r=0;r<e.length;r++){var n=t(e[r]);if(R.isSome(n))return n}return R.none}};i.findFirstMap=uf;function af(t){return function(e){for(var r=e.length-1;r>=0;r--)if(t(e[r]))return R.some(e[r]);return R.none}}i.findLast=af;var cf=function(t){return function(e){for(var r=e.length-1;r>=0;r--){var n=t(e[r]);if(R.isSome(n))return n}return R.none}};i.findLastMap=cf;var pf=function(t){return function(e){for(var r=e.length-1;r>=0;r--)if(t(e[r]))return R.some(r);return R.none}};i.findLastIndex=pf;var ff=function(t,e){return function(r){return t<0||t>r.length?R.none:R.some(M.unsafeInsertAt(t,e,r))}};i.insertAt=ff;var lf=function(t,e){return i.modifyAt(t,function(){return e})};i.updateAt=lf;var df=function(t){return function(e){return i.isOutOfBound(t,e)?R.none:R.some(i.unsafeDeleteAt(t,e))}};i.deleteAt=df;var sf=function(t,e){return function(r){return i.isOutOfBound(t,r)?R.none:R.some(i.unsafeUpdateAt(t,e(r[t]),r))}};i.modifyAt=sf;var mf=function(t){return t.length<=1?t:t.slice().reverse()};i.reverse=mf;var hf=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n._tag==="Right"&&e.push(n.right)}return e};i.rights=hf;var vf=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n._tag==="Left"&&e.push(n.left)}return e};i.lefts=vf;var gf=function(t){return function(e){return e.length<=1?e:e.slice().sort(t.compare)}};i.sort=gf;var yf=function(t,e,r){for(var n=[],u=Math.min(t.length,e.length),f=0;f<u;f++)n[f]=r(t[f],e[f]);return n};i.zipWith=yf;function $n(t,e){return e===void 0?function(r){return $n(r,t)}:i.zipWith(t,e,function(r,n){return[r,n]})}i.zip=$n;var If=function(t){for(var e=[],r=[],n=0;n<t.length;n++)e[n]=t[n][0],r[n]=t[n][1];return[e,r]};i.unzip=If;var xf=function(t){var e=M.prependAll(t);return function(r){return i.isNonEmpty(r)?e(r):r}};i.prependAll=xf;var Rf=function(t){var e=M.intersperse(t);return function(r){return i.isNonEmpty(r)?e(r):r}};i.intersperse=Rf;var Wf=function(t){var e=M.rotate(t);return function(r){return i.isNonEmpty(r)?e(r):r}};i.rotate=Wf;function te(t){return function(e,r){if(r===void 0){var n=te(t);return function(l){return n(e,l)}}for(var u=function(l){return t.equals(l,e)},f=0;f<r.length;f++)if(u(r[f]))return!0;return!1}}i.elem=te;var Mf=function(t){var e=M.uniq(t);return function(r){return i.isNonEmpty(r)?e(r):r}};i.uniq=Mf;var Sf=function(t){var e=M.sortBy(t);return function(r){return i.isNonEmpty(r)?e(r):r}};i.sortBy=Sf;var bf=function(t){var e=M.chop(t);return function(r){return i.isNonEmpty(r)?e(r):i.empty}};i.chop=bf;var Af=function(t){return function(e){return t>=1&&i.isNonEmpty(e)?M.splitAt(t)(e):i.isEmpty(e)?[e,i.empty]:[i.empty,e]}};i.splitAt=Af;var _f=function(t){var e=M.chunksOf(t);return function(r){return i.isNonEmpty(r)?e(r):i.empty}};i.chunksOf=_f;var Vf=function(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return i.fromOption(t.apply(void 0,e))}};i.fromOptionK=Vf;function Of(t,e,r){r===void 0&&(r=function(){return!0});var n=function(u,f){return i.isNonEmpty(f)?S.pipe(M.head(f),i.chain(function(l){return n(S.pipe(u,i.append(l)),M.tail(f))})):r.apply(void 0,u)?[e.apply(void 0,u)]:i.empty};return n(i.empty,t)}i.comprehension=Of;var Ef=function(t){return function(e){return i.isEmpty(e)?t:i.isEmpty(t)?e:e.concat(t)}};i.concatW=Ef;i.concat=i.concatW;function ir(t){var e=M.union(t);return function(r,n){if(n===void 0){var u=ir(t);return function(f){return u(f,r)}}return i.isNonEmpty(r)&&i.isNonEmpty(n)?e(n)(r):i.isNonEmpty(r)?r:n}}i.union=ir;function or(t){var e=te(t);return function(r,n){if(n===void 0){var u=or(t);return function(f){return u(f,r)}}return r.filter(function(f){return e(f,n)})}}i.intersection=or;function ur(t){var e=te(t);return function(r,n){if(n===void 0){var u=ur(t);return function(f){return u(f,r)}}return r.filter(function(f){return!e(f,n)})}}i.difference=ur;var N=function(t,e){return S.pipe(t,i.map(e))},ee=function(t,e){return S.pipe(t,i.mapWithIndex(e))},ot=function(t,e){return S.pipe(t,i.ap(e))},Tt=function(t,e){return S.pipe(t,i.chain(e))},re=function(t,e){return S.pipe(t,i.filter(e))},ne=function(t,e){return S.pipe(t,i.filterMap(e))},ie=function(t,e){return S.pipe(t,i.partition(e))},oe=function(t,e){return S.pipe(t,i.partitionMap(e))},Jn=function(t,e){return S.pipe(t,i.partitionWithIndex(e))},Xn=function(t,e){return S.pipe(t,i.partitionMapWithIndex(e))},ar=function(t,e){return S.pipe(t,i.alt(e))},ft=function(t,e,r){return S.pipe(t,i.reduce(e,r))},gt=function(t){var e=i.foldMap(t);return function(r,n){return S.pipe(r,e(n))}},yt=function(t,e,r){return S.pipe(t,i.reduceRight(e,r))},cr=function(t,e,r){return S.pipe(t,i.reduceWithIndex(e,r))},pr=function(t){var e=i.foldMapWithIndex(t);return function(r,n){return S.pipe(r,e(n))}},fr=function(t,e,r){return S.pipe(t,i.reduceRightWithIndex(e,r))},kn=function(t,e){return S.pipe(t,i.filterMapWithIndex(e))},ti=function(t,e){return S.pipe(t,i.filterWithIndex(e))},ei=function(t,e){return S.pipe(t,i.extend(e))},ue=function(t){var e=i.traverse(t);return function(r,n){return S.pipe(r,e(n))}},ri=function(t){var e=i.traverseWithIndex(t);return function(r,n){return S.pipe(r,e(n))}},Uf=function(t,e){return S.pipe(t,i.chainRecDepthFirst(e))};i._chainRecDepthFirst=Uf;var Ff=function(t,e){return S.pipe(t,i.chainRecBreadthFirst(e))};i._chainRecBreadthFirst=Ff;i.of=M.of;var qf=function(){return i.empty};i.zero=qf;var Cf=function(t){return function(e){return e.concat(t())}};i.altW=Cf;i.alt=i.altW;var wf=function(t){return i.chain(function(e){return S.pipe(t,i.map(e))})};i.ap=wf;var Pf=function(t){return function(e){return S.pipe(e,i.chainWithIndex(function(r,n){return t(n)}))}};i.chain=Pf;i.flatten=i.chain(S.identity);var Nf=function(t){return function(e){return e.map(function(r){return t(r)})}};i.map=Nf;var Lf=function(t){return function(e){return e.map(function(r,n){return t(n,r)})}};i.mapWithIndex=Lf;var Tf=function(t){for(var e=[],r=[],n=0,u=t;n<u.length;n++){var f=u[n];f._tag==="Left"?e.push(f.left):r.push(f.right)}return rr.separated(e,r)};i.separate=Tf;var jf=function(t){return function(e){return e.filter(t)}};i.filter=jf;var zf=function(t){return function(e){for(var r=[],n=0;n<e.length;n++){var u=t(n,e[n]);R.isSome(u)&&r.push(u.value)}return r}};i.filterMapWithIndex=zf;var Bf=function(t){return i.filterMapWithIndex(function(e,r){return t(r)})};i.filterMap=Bf;i.compact=i.filterMap(S.identity);var Df=function(t){return i.partitionWithIndex(function(e,r){return t(r)})};i.partition=Df;var Hf=function(t){return function(e){for(var r=[],n=[],u=0;u<e.length;u++){var f=e[u];t(u,f)?n.push(f):r.push(f)}return rr.separated(r,n)}};i.partitionWithIndex=Hf;var Kf=function(t){return i.partitionMapWithIndex(function(e,r){return t(r)})};i.partitionMap=Kf;var Zf=function(t){return function(e){for(var r=[],n=[],u=0;u<e.length;u++){var f=t(u,e[u]);f._tag==="Left"?r.push(f.left):n.push(f.right)}return rr.separated(r,n)}};i.partitionMapWithIndex=Zf;var Gf=function(t){return function(e){return e.filter(function(r,n){return t(n,r)})}};i.filterWithIndex=Gf;var Qf=function(t){return function(e){return e.map(function(r,n){return t(e.slice(n))})}};i.extend=Qf;i.duplicate=i.extend(S.identity);var Yf=function(t){return function(e){return function(r){return r.reduce(function(n,u,f){return t.concat(n,e(f,u))},t.empty)}}};i.foldMapWithIndex=Yf;var $f=function(t,e){return i.reduceWithIndex(t,function(r,n,u){return e(n,u)})};i.reduce=$f;var Jf=function(t){var e=i.foldMapWithIndex(t);return function(r){return e(function(n,u){return r(u)})}};i.foldMap=Jf;var Xf=function(t,e){return function(r){for(var n=r.length,u=t,f=0;f<n;f++)u=e(f,u,r[f]);return u}};i.reduceWithIndex=Xf;var kf=function(t,e){return i.reduceRightWithIndex(t,function(r,n,u){return e(n,u)})};i.reduceRight=kf;var tl=function(t,e){return function(r){return r.reduceRight(function(n,u,f){return e(f,u,n)},t)}};i.reduceRightWithIndex=tl;var el=function(t){var e=i.traverseWithIndex(t);return function(r){return e(function(n,u){return r(u)})}};i.traverse=el;var rl=function(t){return function(e){return ft(e,t.of(i.zero()),function(r,n){return t.ap(t.map(r,function(u){return function(f){return S.pipe(u,i.append(f))}}),n)})}};i.sequence=rl;var nl=function(t){return function(e){return i.reduceWithIndex(t.of(i.zero()),function(r,n,u){return t.ap(t.map(n,function(f){return function(l){return S.pipe(f,i.append(l))}}),e(r,u))})}};i.traverseWithIndex=nl;var il=function(t){var e=lr(t);return function(r){return function(n){return e(n,r)}}};i.wither=il;var ol=function(t){var e=dr(t);return function(r){return function(n){return e(n,r)}}};i.wilt=ol;var ul=function(t,e){for(var r=[],n=t;;){var u=e(n);if(R.isSome(u)){var f=u.value,l=f[0],d=f[1];r.push(l),n=d}else break}return r};i.unfold=ul;i.URI="ReadonlyArray";var al=function(t){return{show:function(e){return"["+e.map(t.show).join(", ")+"]"}}};i.getShow=al;var cl=function(){return{concat:function(t,e){return i.isEmpty(t)?e:i.isEmpty(e)?t:t.concat(e)}}};i.getSemigroup=cl;var pl=function(){return{concat:i.getSemigroup().concat,empty:i.empty}};i.getMonoid=pl;var fl=function(t){return Vp.fromEquals(function(e,r){return e.length===r.length&&e.every(function(n,u){return t.equals(n,r[u])})})};i.getEq=fl;var ll=function(t){return Up.fromCompare(function(e,r){for(var n=e.length,u=r.length,f=Math.min(n,u),l=0;l<f;l++){var d=t.compare(e[l],r[l]);if(d!==0)return d}return Ep.Ord.compare(n,u)})};i.getOrd=ll;var dl=function(t){var e=ir(t);return{concat:function(r,n){return e(n)(r)}}};i.getUnionSemigroup=dl;var sl=function(t){return{concat:i.getUnionSemigroup(t).concat,empty:i.empty}};i.getUnionMonoid=sl;var ml=function(t){var e=or(t);return{concat:function(r,n){return e(n)(r)}}};i.getIntersectionSemigroup=ml;var hl=function(t){var e=ur(t);return{concat:function(r,n){return e(n)(r)}}};i.getDifferenceMagma=hl;i.Functor={URI:i.URI,map:N};i.flap=Gn.flap(i.Functor);i.Pointed={URI:i.URI,of:i.of};i.FunctorWithIndex={URI:i.URI,map:N,mapWithIndex:ee};i.Apply={URI:i.URI,map:N,ap:ot};i.apFirst=er.apFirst(i.Apply);i.apSecond=er.apSecond(i.Apply);i.Applicative={URI:i.URI,map:N,ap:ot,of:i.of};i.Chain={URI:i.URI,map:N,ap:ot,chain:Tt};i.Monad={URI:i.URI,map:N,ap:ot,of:i.of,chain:Tt};i.chainFirst=Zn.chainFirst(i.Chain);i.Unfoldable={URI:i.URI,unfold:i.unfold};i.Alt={URI:i.URI,map:N,alt:ar};i.Zero={URI:i.URI,zero:i.zero};i.guard=Fp.guard(i.Zero,i.Pointed);i.Alternative={URI:i.URI,map:N,ap:ot,of:i.of,alt:ar,zero:i.zero};i.Extend={URI:i.URI,map:N,extend:ei};i.Compactable={URI:i.URI,compact:i.compact,separate:i.separate};i.Filterable={URI:i.URI,map:N,compact:i.compact,separate:i.separate,filter:re,filterMap:ne,partition:ie,partitionMap:oe};i.FilterableWithIndex={URI:i.URI,map:N,mapWithIndex:ee,compact:i.compact,separate:i.separate,filter:re,filterMap:ne,partition:ie,partitionMap:oe,partitionMapWithIndex:Xn,partitionWithIndex:Jn,filterMapWithIndex:kn,filterWithIndex:ti};i.Foldable={URI:i.URI,reduce:ft,foldMap:gt,reduceRight:yt};i.FoldableWithIndex={URI:i.URI,reduce:ft,foldMap:gt,reduceRight:yt,reduceWithIndex:cr,foldMapWithIndex:pr,reduceRightWithIndex:fr};i.Traversable={URI:i.URI,map:N,reduce:ft,foldMap:gt,reduceRight:yt,traverse:ue,sequence:i.sequence};i.TraversableWithIndex={URI:i.URI,map:N,mapWithIndex:ee,reduce:ft,foldMap:gt,reduceRight:yt,reduceWithIndex:cr,foldMapWithIndex:pr,reduceRightWithIndex:fr,traverse:ue,sequence:i.sequence,traverseWithIndex:ri};var vl=function(t){return function(e){for(var r=_p([],t(e)),n=[];r.length>0;){var u=r.shift();R.isLeft(u)?r.unshift.apply(r,t(u.left)):n.push(u.right)}return n}};i.chainRecDepthFirst=vl;i.ChainRecDepthFirst={URI:i.URI,map:N,ap:ot,chain:Tt,chainRec:i._chainRecDepthFirst};var gl=function(t){return function(e){var r=t(e),n=[],u=[];function f(y){R.isLeft(y)?t(y.left).forEach(function(W){return n.push(W)}):u.push(y.right)}for(var l=0,d=r;l<d.length;l++){var g=d[l];f(g)}for(;n.length>0;)f(n.shift());return u}};i.chainRecBreadthFirst=gl;i.ChainRecBreadthFirst={URI:i.URI,map:N,ap:ot,chain:Tt,chainRec:i._chainRecBreadthFirst};var lr=nr.witherDefault(i.Traversable,i.Compactable),dr=nr.wiltDefault(i.Traversable,i.Compactable);i.Witherable={URI:i.URI,map:N,compact:i.compact,separate:i.separate,filter:re,filterMap:ne,partition:ie,partitionMap:oe,reduce:ft,foldMap:gt,reduceRight:yt,traverse:ue,sequence:i.sequence,wither:lr,wilt:dr};i.filterE=nr.filterE(i.Witherable);i.FromEither={URI:i.URI,fromEither:i.fromEither};i.fromEitherK=Op.fromEitherK(i.FromEither);i.unsafeInsertAt=M.unsafeInsertAt;var yl=function(t,e,r){return i.isNonEmpty(r)?M.unsafeUpdateAt(t,e,r):r};i.unsafeUpdateAt=yl;var Il=function(t,e){var r=e.slice();return r.splice(t,1),r};i.unsafeDeleteAt=Il;var xl=function(t){return t.slice()};i.toArray=xl;var Rl=function(t){return i.isEmpty(t)?i.empty:t.slice()};i.fromArray=Rl;i.empty=M.empty;var Wl=function(t){return function(e){return e.every(t)}};i.every=Wl;var Ml=function(t){return function(e){return e.some(t)}};i.some=Ml;i.exists=i.some;i.Do=i.of(R.emptyRecord);i.bindTo=Gn.bindTo(i.Functor);i.bind=Zn.bind(i.Chain);i.apS=er.apS(i.Apply);i.range=M.range;i.cons=M.cons;i.snoc=M.snoc;i.prependToAll=i.prependAll;i.readonlyArray={URI:i.URI,compact:i.compact,separate:i.separate,map:N,ap:ot,of:i.of,chain:Tt,filter:re,filterMap:ne,partition:ie,partitionMap:oe,mapWithIndex:ee,partitionMapWithIndex:Xn,partitionWithIndex:Jn,filterMapWithIndex:kn,filterWithIndex:ti,alt:ar,zero:i.zero,unfold:i.unfold,reduce:ft,foldMap:gt,reduceRight:yt,traverse:ue,sequence:i.sequence,reduceWithIndex:cr,foldMapWithIndex:pr,reduceRightWithIndex:fr,traverseWithIndex:ri,extend:ei,wither:lr,wilt:dr}});var mi=w(o=>{"use strict";var Sl=o&&o.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),bl=o&&o.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),sr=o&&o.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Sl(e,t,r);return bl(e,t),e};Object.defineProperty(o,"__esModule",{value:!0});o.lefts=o.rights=o.reverse=o.modifyAt=o.deleteAt=o.updateAt=o.insertAt=o.copy=o.findLastIndex=o.findLastMap=o.findLast=o.findFirstMap=o.findFirst=o.findIndex=o.dropLeftWhile=o.dropRight=o.dropLeft=o.spanLeft=o.takeLeftWhile=o.takeRight=o.takeLeft=o.init=o.tail=o.last=o.head=o.lookup=o.isOutOfBound=o.size=o.scanRight=o.scanLeft=o.chainWithIndex=o.foldRight=o.matchRight=o.matchRightW=o.foldLeft=o.matchLeft=o.matchLeftW=o.match=o.matchW=o.fromEither=o.fromOption=o.fromPredicate=o.replicate=o.makeBy=o.appendW=o.append=o.prependW=o.prepend=o.isNonEmpty=o.isEmpty=void 0;o.traverseWithIndex=o.sequence=o.traverse=o.reduceRightWithIndex=o.reduceRight=o.reduceWithIndex=o.reduce=o.foldMapWithIndex=o.foldMap=o.duplicate=o.extend=o.filterWithIndex=o.alt=o.altW=o.partitionMapWithIndex=o.partitionMap=o.partitionWithIndex=o.partition=o.filter=o.separate=o.compact=o.filterMap=o.filterMapWithIndex=o.mapWithIndex=o.flatten=o.chain=o.ap=o.map=o.zero=o.of=o.difference=o.intersection=o.union=o.concat=o.concatW=o.comprehension=o.fromOptionK=o.chunksOf=o.splitAt=o.chop=o.sortBy=o.uniq=o.elem=o.rotate=o.intersperse=o.prependAll=o.unzip=o.zip=o.zipWith=o.sort=void 0;o.some=o.every=o.unsafeDeleteAt=o.unsafeUpdateAt=o.unsafeInsertAt=o.fromEitherK=o.FromEither=o.filterE=o.ChainRecBreadthFirst=o.chainRecBreadthFirst=o.ChainRecDepthFirst=o.chainRecDepthFirst=o.Witherable=o.TraversableWithIndex=o.Traversable=o.FoldableWithIndex=o.Foldable=o.FilterableWithIndex=o.Filterable=o.Compactable=o.Extend=o.Alternative=o.guard=o.Zero=o.Alt=o.Unfoldable=o.Monad=o.chainFirst=o.Chain=o.Applicative=o.apSecond=o.apFirst=o.Apply=o.FunctorWithIndex=o.Pointed=o.flap=o.Functor=o.getDifferenceMagma=o.getIntersectionSemigroup=o.getUnionMonoid=o.getUnionSemigroup=o.getOrd=o.getEq=o.getMonoid=o.getSemigroup=o.getShow=o.URI=o.unfold=o.wilt=o.wither=void 0;o.array=o.prependToAll=o.snoc=o.cons=o.empty=o.range=o.apS=o.bind=o.bindTo=o.Do=o.exists=void 0;var mr=ct(),ii=vt(),Al=Zt(),A=P(),oi=nt(),z=sr(k()),_=sr(Hn()),U=sr(ni()),hr=$t(),vr=Jt(),_l=kt(),Vl=function(t){return t.length===0};o.isEmpty=Vl;o.isNonEmpty=_.isNonEmpty;o.prepend=_.prepend;o.prependW=_.prependW;o.append=_.append;o.appendW=_.appendW;var Ol=function(t,e){return t<=0?[]:_.makeBy(e)(t)};o.makeBy=Ol;var El=function(t,e){return o.makeBy(t,function(){return e})};o.replicate=El;function Ul(t){return function(e){return t(e)?[e]:[]}}o.fromPredicate=Ul;var Fl=function(t){return z.isNone(t)?[]:[t.value]};o.fromOption=Fl;var ql=function(t){return z.isLeft(t)?[]:[t.right]};o.fromEither=ql;var Cl=function(t,e){return function(r){return o.isNonEmpty(r)?e(r):t()}};o.matchW=Cl;o.match=o.matchW;var wl=function(t,e){return function(r){return o.isNonEmpty(r)?e(_.head(r),_.tail(r)):t()}};o.matchLeftW=wl;o.matchLeft=o.matchLeftW;o.foldLeft=o.matchLeft;var Pl=function(t,e){return function(r){return o.isNonEmpty(r)?e(_.init(r),_.last(r)):t()}};o.matchRightW=Pl;o.matchRight=o.matchRightW;o.foldRight=o.matchRight;var Nl=function(t){return function(e){for(var r=[],n=0;n<e.length;n++)r.push.apply(r,t(n,e[n]));return r}};o.chainWithIndex=Nl;var Ll=function(t,e){return function(r){var n=r.length,u=new Array(n+1);u[0]=t;for(var f=0;f<n;f++)u[f+1]=e(u[f],r[f]);return u}};o.scanLeft=Ll;var Tl=function(t,e){return function(r){var n=r.length,u=new Array(n+1);u[n]=t;for(var f=n-1;f>=0;f--)u[f]=e(r[f],u[f+1]);return u}};o.scanRight=Tl;var jl=function(t){return t.length};o.size=jl;o.isOutOfBound=_.isOutOfBound;o.lookup=U.lookup;o.head=U.head;o.last=U.last;var zl=function(t){return o.isNonEmpty(t)?z.some(_.tail(t)):z.none};o.tail=zl;var Bl=function(t){return o.isNonEmpty(t)?z.some(_.init(t)):z.none};o.init=Bl;var Dl=function(t){return function(e){return o.isOutOfBound(t,e)?o.copy(e):e.slice(0,t)}};o.takeLeft=Dl;var Hl=function(t){return function(e){return o.isOutOfBound(t,e)?o.copy(e):t===0?[]:e.slice(-t)}};o.takeRight=Hl;function Kl(t){return function(e){for(var r=[],n=0,u=e;n<u.length;n++){var f=u[n];if(!t(f))break;r.push(f)}return r}}o.takeLeftWhile=Kl;var ui=function(t,e){for(var r=t.length,n=0;n<r&&e(t[n]);n++);return n};function Zl(t){return function(e){var r=o.splitAt(ui(e,t))(e),n=r[0],u=r[1];return{init:n,rest:u}}}o.spanLeft=Zl;var Gl=function(t){return function(e){return t<=0||o.isEmpty(e)?o.copy(e):t>=e.length?[]:e.slice(t,e.length)}};o.dropLeft=Gl;var Ql=function(t){return function(e){return t<=0||o.isEmpty(e)?o.copy(e):t>=e.length?[]:e.slice(0,e.length-t)}};o.dropRight=Ql;function Yl(t){return function(e){return e.slice(ui(e,t))}}o.dropLeftWhile=Yl;o.findIndex=U.findIndex;function $l(t){return U.findFirst(t)}o.findFirst=$l;o.findFirstMap=U.findFirstMap;function Jl(t){return U.findLast(t)}o.findLast=Jl;o.findLastMap=U.findLastMap;o.findLastIndex=U.findLastIndex;var Xl=function(t){return t.slice()};o.copy=Xl;var kl=function(t,e){return function(r){return t<0||t>r.length?z.none:z.some(o.unsafeInsertAt(t,e,r))}};o.insertAt=kl;var td=function(t,e){return o.modifyAt(t,function(){return e})};o.updateAt=td;var ed=function(t){return function(e){return o.isOutOfBound(t,e)?z.none:z.some(o.unsafeDeleteAt(t,e))}};o.deleteAt=ed;var rd=function(t,e){return function(r){return o.isOutOfBound(t,r)?z.none:z.some(o.unsafeUpdateAt(t,e(r[t]),r))}};o.modifyAt=rd;var nd=function(t){return o.isEmpty(t)?[]:t.slice().reverse()};o.reverse=nd;var id=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n._tag==="Right"&&e.push(n.right)}return e};o.rights=id;var od=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n._tag==="Left"&&e.push(n.left)}return e};o.lefts=od;var ud=function(t){return function(e){return e.length<=1?o.copy(e):e.slice().sort(t.compare)}};o.sort=ud;var ad=function(t,e,r){for(var n=[],u=Math.min(t.length,e.length),f=0;f<u;f++)n[f]=r(t[f],e[f]);return n};o.zipWith=ad;function ai(t,e){return e===void 0?function(r){return ai(r,t)}:o.zipWith(t,e,function(r,n){return[r,n]})}o.zip=ai;var cd=function(t){for(var e=[],r=[],n=0;n<t.length;n++)e[n]=t[n][0],r[n]=t[n][1];return[e,r]};o.unzip=cd;var pd=function(t){var e=_.prependAll(t);return function(r){return o.isNonEmpty(r)?e(r):[]}};o.prependAll=pd;var fd=function(t){var e=_.intersperse(t);return function(r){return o.isNonEmpty(r)?e(r):o.copy(r)}};o.intersperse=fd;var ld=function(t){var e=_.rotate(t);return function(r){return o.isNonEmpty(r)?e(r):o.copy(r)}};o.rotate=ld;o.elem=U.elem;var dd=function(t){var e=_.uniq(t);return function(r){return o.isNonEmpty(r)?e(r):o.copy(r)}};o.uniq=dd;var sd=function(t){var e=_.sortBy(t);return function(r){return o.isNonEmpty(r)?e(r):o.copy(r)}};o.sortBy=sd;var md=function(t){var e=_.chop(t);return function(r){return o.isNonEmpty(r)?e(r):[]}};o.chop=md;var hd=function(t){return function(e){return t>=1&&o.isNonEmpty(e)?_.splitAt(t)(e):o.isEmpty(e)?[o.copy(e),[]]:[[],o.copy(e)]}};o.splitAt=hd;var vd=function(t){var e=_.chunksOf(t);return function(r){return o.isNonEmpty(r)?e(r):[]}};o.chunksOf=vd;var gd=function(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return o.fromOption(t.apply(void 0,e))}};o.fromOptionK=gd;function yd(t,e,r){r===void 0&&(r=function(){return!0});var n=function(u,f){return o.isNonEmpty(f)?A.pipe(_.head(f),o.chain(function(l){return n(A.pipe(u,o.append(l)),_.tail(f))})):r.apply(void 0,u)?[e.apply(void 0,u)]:[]};return n([],t)}o.comprehension=yd;var Id=function(t){return function(e){return o.isEmpty(e)?o.copy(t):o.isEmpty(t)?o.copy(e):e.concat(t)}};o.concatW=Id;o.concat=o.concatW;function gr(t){var e=_.union(t);return function(r,n){if(n===void 0){var u=gr(t);return function(f){return u(f,r)}}return o.isNonEmpty(r)&&o.isNonEmpty(n)?e(n)(r):o.isNonEmpty(r)?o.copy(r):o.copy(n)}}o.union=gr;function yr(t){var e=o.elem(t);return function(r,n){if(n===void 0){var u=yr(t);return function(f){return u(f,r)}}return r.filter(function(f){return e(f,n)})}}o.intersection=yr;function Ir(t){var e=o.elem(t);return function(r,n){if(n===void 0){var u=Ir(t);return function(f){return u(f,r)}}return r.filter(function(f){return!e(f,n)})}}o.difference=Ir;var L=function(t,e){return A.pipe(t,o.map(e))},ae=function(t,e){return A.pipe(t,o.mapWithIndex(e))},ut=function(t,e){return A.pipe(t,o.ap(e))},jt=function(t,e){return A.pipe(t,o.chain(e))},ce=function(t,e){return A.pipe(t,o.filter(e))},pe=function(t,e){return A.pipe(t,o.filterMap(e))},fe=function(t,e){return A.pipe(t,o.partition(e))},le=function(t,e){return A.pipe(t,o.partitionMap(e))},ci=function(t,e){return A.pipe(t,o.partitionWithIndex(e))},pi=function(t,e){return A.pipe(t,o.partitionMapWithIndex(e))},xr=function(t,e){return A.pipe(t,o.alt(e))},lt=function(t,e,r){return A.pipe(t,o.reduce(e,r))},It=function(t){var e=o.foldMap(t);return function(r,n){return A.pipe(r,e(n))}},xt=function(t,e,r){return A.pipe(t,o.reduceRight(e,r))},Rr=function(t,e,r){return A.pipe(t,o.reduceWithIndex(e,r))},Wr=function(t){var e=o.foldMapWithIndex(t);return function(r,n){return A.pipe(r,e(n))}},Mr=function(t,e,r){return A.pipe(t,o.reduceRightWithIndex(e,r))},fi=function(t,e){return A.pipe(t,o.filterMapWithIndex(e))},li=function(t,e){return A.pipe(t,o.filterWithIndex(e))},di=function(t,e){return A.pipe(t,o.extend(e))},de=function(t){var e=o.traverse(t);return function(r,n){return A.pipe(r,e(n))}},si=function(t){var e=o.traverseWithIndex(t);return function(r,n){return A.pipe(r,e(n))}},xd=U._chainRecDepthFirst,Rd=U._chainRecBreadthFirst;o.of=_.of;var Wd=function(){return[]};o.zero=Wd;var Md=function(t){return function(e){return e.map(function(r){return t(r)})}};o.map=Md;var Sd=function(t){return o.chain(function(e){return A.pipe(t,o.map(e))})};o.ap=Sd;var bd=function(t){return function(e){return A.pipe(e,o.chainWithIndex(function(r,n){return t(n)}))}};o.chain=bd;o.flatten=o.chain(A.identity);var Ad=function(t){return function(e){return e.map(function(r,n){return t(n,r)})}};o.mapWithIndex=Ad;var _d=function(t){return function(e){for(var r=[],n=0;n<e.length;n++){var u=t(n,e[n]);z.isSome(u)&&r.push(u.value)}return r}};o.filterMapWithIndex=_d;var Vd=function(t){return o.filterMapWithIndex(function(e,r){return t(r)})};o.filterMap=Vd;o.compact=o.filterMap(A.identity);var Od=function(t){for(var e=[],r=[],n=0,u=t;n<u.length;n++){var f=u[n];f._tag==="Left"?e.push(f.left):r.push(f.right)}return hr.separated(e,r)};o.separate=Od;var Ed=function(t){return function(e){return e.filter(t)}};o.filter=Ed;var Ud=function(t){return o.partitionWithIndex(function(e,r){return t(r)})};o.partition=Ud;var Fd=function(t){return function(e){for(var r=[],n=[],u=0;u<e.length;u++){var f=e[u];t(u,f)?n.push(f):r.push(f)}return hr.separated(r,n)}};o.partitionWithIndex=Fd;var qd=function(t){return o.partitionMapWithIndex(function(e,r){return t(r)})};o.partitionMap=qd;var Cd=function(t){return function(e){for(var r=[],n=[],u=0;u<e.length;u++){var f=t(u,e[u]);f._tag==="Left"?r.push(f.left):n.push(f.right)}return hr.separated(r,n)}};o.partitionMapWithIndex=Cd;var wd=function(t){return function(e){return e.concat(t())}};o.altW=wd;o.alt=o.altW;var Pd=function(t){return function(e){return e.filter(function(r,n){return t(n,r)})}};o.filterWithIndex=Pd;var Nd=function(t){return function(e){return e.map(function(r,n){return t(e.slice(n))})}};o.extend=Nd;o.duplicate=o.extend(A.identity);o.foldMap=U.foldMap;o.foldMapWithIndex=U.foldMapWithIndex;o.reduce=U.reduce;o.reduceWithIndex=U.reduceWithIndex;o.reduceRight=U.reduceRight;o.reduceRightWithIndex=U.reduceRightWithIndex;var Ld=function(t){var e=o.traverseWithIndex(t);return function(r){return e(function(n,u){return r(u)})}};o.traverse=Ld;var Td=function(t){return function(e){return lt(e,t.of(o.zero()),function(r,n){return t.ap(t.map(r,function(u){return function(f){return A.pipe(u,o.append(f))}}),n)})}};o.sequence=Td;var jd=function(t){return function(e){return o.reduceWithIndex(t.of(o.zero()),function(r,n,u){return t.ap(t.map(n,function(f){return function(l){return A.pipe(f,o.append(l))}}),e(r,u))})}};o.traverseWithIndex=jd;var zd=function(t){var e=Sr(t);return function(r){return function(n){return e(n,r)}}};o.wither=zd;var Bd=function(t){var e=br(t);return function(r){return function(n){return e(n,r)}}};o.wilt=Bd;var Dd=function(t,e){for(var r=[],n=t;;){var u=e(n);if(z.isSome(u)){var f=u.value,l=f[0],d=f[1];r.push(l),n=d}else break}return r};o.unfold=Dd;o.URI="Array";o.getShow=U.getShow;var Hd=function(){return{concat:function(t,e){return t.concat(e)}}};o.getSemigroup=Hd;var Kd=function(){return{concat:o.getSemigroup().concat,empty:[]}};o.getMonoid=Kd;o.getEq=U.getEq;o.getOrd=U.getOrd;var Zd=function(t){var e=gr(t);return{concat:function(r,n){return e(n)(r)}}};o.getUnionSemigroup=Zd;var Gd=function(t){return{concat:o.getUnionSemigroup(t).concat,empty:[]}};o.getUnionMonoid=Gd;var Qd=function(t){var e=yr(t);return{concat:function(r,n){return e(n)(r)}}};o.getIntersectionSemigroup=Qd;var Yd=function(t){var e=Ir(t);return{concat:function(r,n){return e(n)(r)}}};o.getDifferenceMagma=Yd;o.Functor={URI:o.URI,map:L};o.flap=oi.flap(o.Functor);o.Pointed={URI:o.URI,of:o.of};o.FunctorWithIndex={URI:o.URI,map:L,mapWithIndex:ae};o.Apply={URI:o.URI,map:L,ap:ut};o.apFirst=mr.apFirst(o.Apply);o.apSecond=mr.apSecond(o.Apply);o.Applicative={URI:o.URI,map:L,ap:ut,of:o.of};o.Chain={URI:o.URI,map:L,ap:ut,chain:jt};o.chainFirst=ii.chainFirst(o.Chain);o.Monad={URI:o.URI,map:L,ap:ut,of:o.of,chain:jt};o.Unfoldable={URI:o.URI,unfold:o.unfold};o.Alt={URI:o.URI,map:L,alt:xr};o.Zero={URI:o.URI,zero:o.zero};o.guard=_l.guard(o.Zero,o.Pointed);o.Alternative={URI:o.URI,map:L,ap:ut,of:o.of,alt:xr,zero:o.zero};o.Extend={URI:o.URI,map:L,extend:di};o.Compactable={URI:o.URI,compact:o.compact,separate:o.separate};o.Filterable={URI:o.URI,map:L,compact:o.compact,separate:o.separate,filter:ce,filterMap:pe,partition:fe,partitionMap:le};o.FilterableWithIndex={URI:o.URI,map:L,mapWithIndex:ae,compact:o.compact,separate:o.separate,filter:ce,filterMap:pe,partition:fe,partitionMap:le,partitionMapWithIndex:pi,partitionWithIndex:ci,filterMapWithIndex:fi,filterWithIndex:li};o.Foldable={URI:o.URI,reduce:lt,foldMap:It,reduceRight:xt};o.FoldableWithIndex={URI:o.URI,reduce:lt,foldMap:It,reduceRight:xt,reduceWithIndex:Rr,foldMapWithIndex:Wr,reduceRightWithIndex:Mr};o.Traversable={URI:o.URI,map:L,reduce:lt,foldMap:It,reduceRight:xt,traverse:de,sequence:o.sequence};o.TraversableWithIndex={URI:o.URI,map:L,mapWithIndex:ae,reduce:lt,foldMap:It,reduceRight:xt,reduceWithIndex:Rr,foldMapWithIndex:Wr,reduceRightWithIndex:Mr,traverse:de,sequence:o.sequence,traverseWithIndex:si};var Sr=vr.witherDefault(o.Traversable,o.Compactable),br=vr.wiltDefault(o.Traversable,o.Compactable);o.Witherable={URI:o.URI,map:L,compact:o.compact,separate:o.separate,filter:ce,filterMap:pe,partition:fe,partitionMap:le,reduce:lt,foldMap:It,reduceRight:xt,traverse:de,sequence:o.sequence,wither:Sr,wilt:br};o.chainRecDepthFirst=U.chainRecDepthFirst;o.ChainRecDepthFirst={URI:o.URI,map:L,ap:ut,chain:jt,chainRec:xd};o.chainRecBreadthFirst=U.chainRecBreadthFirst;o.ChainRecBreadthFirst={URI:o.URI,map:L,ap:ut,chain:jt,chainRec:Rd};o.filterE=vr.filterE(o.Witherable);o.FromEither={URI:o.URI,fromEither:o.fromEither};o.fromEitherK=Al.fromEitherK(o.FromEither);o.unsafeInsertAt=_.unsafeInsertAt;var $d=function(t,e,r){return o.isNonEmpty(r)?_.unsafeUpdateAt(t,e,r):[]};o.unsafeUpdateAt=$d;var Jd=function(t,e){var r=e.slice();return r.splice(t,1),r};o.unsafeDeleteAt=Jd;o.every=U.every;var Xd=function(t){return function(e){return e.some(t)}};o.some=Xd;o.exists=o.some;o.Do=o.of(z.emptyRecord);o.bindTo=oi.bindTo(o.Functor);o.bind=ii.bind(o.Chain);o.apS=mr.apS(o.Apply);o.range=_.range;o.empty=[];o.cons=_.cons;o.snoc=_.snoc;o.prependToAll=o.prependAll;o.array={URI:o.URI,compact:o.compact,separate:o.separate,map:L,ap:ut,of:o.of,chain:jt,filter:ce,filterMap:pe,partition:fe,partitionMap:le,mapWithIndex:ae,partitionMapWithIndex:pi,partitionWithIndex:ci,filterMapWithIndex:fi,filterWithIndex:li,alt:xr,zero:o.zero,unfold:o.unfold,reduce:lt,foldMap:It,reduceRight:xt,traverse:de,sequence:o.sequence,reduceWithIndex:Rr,foldMapWithIndex:Wr,reduceRightWithIndex:Mr,traverseWithIndex:si,extend:di,wither:Sr,wilt:br}});var vi=w(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.getApplicativeComposition=Rt.getApplicativeMonoid=void 0;var hi=ct(),kd=P(),ts=nt();function es(t){var e=hi.getApplySemigroup(t);return function(r){return{concat:e(r).concat,empty:t.of(r.empty)}}}Rt.getApplicativeMonoid=es;function rs(t,e){var r=ts.getFunctorComposition(t,e).map,n=hi.ap(t,e);return{map:r,of:function(u){return t.of(e.of(u))},ap:function(u,f){return kd.pipe(u,n(f))}}}Rt.getApplicativeComposition=rs});var gi=w(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.and=O.or=O.not=O.Contravariant=O.getMonoidAll=O.getSemigroupAll=O.getMonoidAny=O.getSemigroupAny=O.URI=O.contramap=void 0;var Wt=P(),ns=function(t,e){return Wt.pipe(t,O.contramap(e))},is=function(t){return function(e){return Wt.flow(t,e)}};O.contramap=is;O.URI="Predicate";var os=function(){return{concat:function(t,e){return Wt.pipe(t,O.or(e))}}};O.getSemigroupAny=os;var us=function(){return{concat:O.getSemigroupAny().concat,empty:Wt.constFalse}};O.getMonoidAny=us;var as=function(){return{concat:function(t,e){return Wt.pipe(t,O.and(e))}}};O.getSemigroupAll=as;var cs=function(){return{concat:O.getSemigroupAll().concat,empty:Wt.constTrue}};O.getMonoidAll=cs;O.Contravariant={URI:O.URI,contramap:ns};var ps=function(t){return function(e){return!t(e)}};O.not=ps;var fs=function(t){return function(e){return function(r){return e(r)||t(r)}}};O.or=fs;var ls=function(t){return function(e){return function(r){return e(r)&&t(r)}}};O.and=ls});var bi=w(a=>{"use strict";var ds=a&&a.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ss=a&&a.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ms=a&&a.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ds(e,t,r);return ss(e,t),e};Object.defineProperty(a,"__esModule",{value:!0});a.fromEither=a.MonadThrow=a.throwError=a.Witherable=a.wilt=a.wither=a.Traversable=a.sequence=a.traverse=a.Filterable=a.partitionMap=a.partition=a.filterMap=a.filter=a.Compactable=a.separate=a.compact=a.Extend=a.extend=a.Alternative=a.guard=a.Zero=a.zero=a.Alt=a.alt=a.altW=a.Foldable=a.reduceRight=a.foldMap=a.reduce=a.Monad=a.Chain=a.chain=a.Applicative=a.Apply=a.ap=a.Pointed=a.of=a.Functor=a.map=a.getMonoid=a.getOrd=a.getEq=a.getShow=a.URI=a.getRight=a.getLeft=a.fromPredicate=a.some=a.none=void 0;a.getLastMonoid=a.getFirstMonoid=a.getApplyMonoid=a.getApplySemigroup=a.option=a.mapNullable=a.getRefinement=a.sequenceArray=a.traverseArray=a.traverseArrayWithIndex=a.traverseReadonlyArrayWithIndex=a.traverseReadonlyNonEmptyArrayWithIndex=a.ApT=a.apS=a.bind=a.bindTo=a.Do=a.exists=a.elem=a.toUndefined=a.toNullable=a.chainNullableK=a.fromNullableK=a.tryCatchK=a.tryCatch=a.fromNullable=a.chainEitherK=a.fromEitherK=a.duplicate=a.chainFirst=a.flatten=a.apSecond=a.apFirst=a.flap=a.getOrElse=a.getOrElseW=a.fold=a.match=a.foldW=a.matchW=a.isNone=a.isSome=a.FromEither=void 0;var hs=vi(),se=ct(),yi=vt(),Ii=Zt(),C=P(),xi=nt(),dt=ms(k()),vs=gi(),Ri=Pe(),Ar=$t(),Wi=Jt(),gs=kt();a.none=dt.none;a.some=dt.some;function ys(t){return function(e){return t(e)?a.some(e):a.none}}a.fromPredicate=ys;var Is=function(t){return t._tag==="Right"?a.none:a.some(t.left)};a.getLeft=Is;var xs=function(t){return t._tag==="Left"?a.none:a.some(t.right)};a.getRight=xs;var K=function(t,e){return C.pipe(t,a.map(e))},st=function(t,e){return C.pipe(t,a.ap(e))},me=function(t,e){return C.pipe(t,a.chain(e))},he=function(t,e,r){return C.pipe(t,a.reduce(e,r))},ve=function(t){var e=a.foldMap(t);return function(r,n){return C.pipe(r,e(n))}},ge=function(t,e,r){return C.pipe(t,a.reduceRight(e,r))},_r=function(t){var e=a.traverse(t);return function(r,n){return C.pipe(r,e(n))}},Vr=function(t,e){return C.pipe(t,a.alt(e))},zt=function(t,e){return C.pipe(t,a.filter(e))},Or=function(t,e){return C.pipe(t,a.filterMap(e))},Mi=function(t,e){return C.pipe(t,a.extend(e))},Er=function(t,e){return C.pipe(t,a.partition(e))},Ur=function(t,e){return C.pipe(t,a.partitionMap(e))};a.URI="Option";var Rs=function(t){return{show:function(e){return a.isNone(e)?"none":"some("+t.show(e.value)+")"}}};a.getShow=Rs;var Ws=function(t){return{equals:function(e,r){return e===r||(a.isNone(e)?a.isNone(r):a.isNone(r)?!1:t.equals(e.value,r.value))}}};a.getEq=Ws;var Ms=function(t){return{equals:a.getEq(t).equals,compare:function(e,r){return e===r?0:a.isSome(e)?a.isSome(r)?t.compare(e.value,r.value):1:-1}}};a.getOrd=Ms;var Ss=function(t){return{concat:function(e,r){return a.isNone(e)?r:a.isNone(r)?e:a.some(t.concat(e.value,r.value))},empty:a.none}};a.getMonoid=Ss;var bs=function(t){return function(e){return a.isNone(e)?a.none:a.some(t(e.value))}};a.map=bs;a.Functor={URI:a.URI,map:K};a.of=a.some;a.Pointed={URI:a.URI,of:a.of};var As=function(t){return function(e){return a.isNone(e)||a.isNone(t)?a.none:a.some(e.value(t.value))}};a.ap=As;a.Apply={URI:a.URI,map:K,ap:st};a.Applicative={URI:a.URI,map:K,ap:st,of:a.of};var _s=function(t){return function(e){return a.isNone(e)?a.none:t(e.value)}};a.chain=_s;a.Chain={URI:a.URI,map:K,ap:st,chain:me};a.Monad={URI:a.URI,map:K,ap:st,of:a.of,chain:me};var Vs=function(t,e){return function(r){return a.isNone(r)?t:e(t,r.value)}};a.reduce=Vs;var Os=function(t){return function(e){return function(r){return a.isNone(r)?t.empty:e(r.value)}}};a.foldMap=Os;var Es=function(t,e){return function(r){return a.isNone(r)?t:e(r.value,t)}};a.reduceRight=Es;a.Foldable={URI:a.URI,reduce:he,foldMap:ve,reduceRight:ge};var Us=function(t){return function(e){return a.isNone(e)?t():e}};a.altW=Us;a.alt=a.altW;a.Alt={URI:a.URI,map:K,alt:Vr};var Fs=function(){return a.none};a.zero=Fs;a.Zero={URI:a.URI,zero:a.zero};a.guard=gs.guard(a.Zero,a.Pointed);a.Alternative={URI:a.URI,map:K,ap:st,of:a.of,alt:Vr,zero:a.zero};var qs=function(t){return function(e){return a.isNone(e)?a.none:a.some(t(e))}};a.extend=qs;a.Extend={URI:a.URI,map:K,extend:Mi};a.compact=a.chain(C.identity);var Cs=Ar.separated(a.none,a.none),ws=function(t){return a.isNone(t)?Cs:Ar.separated(a.getLeft(t.value),a.getRight(t.value))};a.separate=ws;a.Compactable={URI:a.URI,compact:a.compact,separate:a.separate};var Ps=function(t){return function(e){return a.isNone(e)?a.none:t(e.value)?e:a.none}};a.filter=Ps;var Ns=function(t){return function(e){return a.isNone(e)?a.none:t(e.value)}};a.filterMap=Ns;var Ls=function(t){return function(e){return Ar.separated(zt(e,vs.not(t)),zt(e,t))}};a.partition=Ls;var Ts=function(t){return C.flow(a.map(t),a.separate)};a.partitionMap=Ts;a.Filterable={URI:a.URI,map:K,compact:a.compact,separate:a.separate,filter:zt,filterMap:Or,partition:Er,partitionMap:Ur};var js=function(t){return function(e){return function(r){return a.isNone(r)?t.of(a.none):t.map(e(r.value),a.some)}}};a.traverse=js;var zs=function(t){return function(e){return a.isNone(e)?t.of(a.none):t.map(e.value,a.some)}};a.sequence=zs;a.Traversable={URI:a.URI,map:K,reduce:he,foldMap:ve,reduceRight:ge,traverse:_r,sequence:a.sequence};var Fr=Wi.witherDefault(a.Traversable,a.Compactable),qr=Wi.wiltDefault(a.Traversable,a.Compactable),Bs=function(t){var e=Fr(t);return function(r){return function(n){return e(n,r)}}};a.wither=Bs;var Ds=function(t){var e=qr(t);return function(r){return function(n){return e(n,r)}}};a.wilt=Ds;a.Witherable={URI:a.URI,map:K,reduce:he,foldMap:ve,reduceRight:ge,traverse:_r,sequence:a.sequence,compact:a.compact,separate:a.separate,filter:zt,filterMap:Or,partition:Er,partitionMap:Ur,wither:Fr,wilt:qr};var Hs=function(){return a.none};a.throwError=Hs;a.MonadThrow={URI:a.URI,map:K,ap:st,of:a.of,chain:me,throwError:a.throwError};a.fromEither=a.getRight;a.FromEither={URI:a.URI,fromEither:a.fromEither};a.isSome=dt.isSome;var Ks=function(t){return t._tag==="None"};a.isNone=Ks;var Zs=function(t,e){return function(r){return a.isNone(r)?t():e(r.value)}};a.matchW=Zs;a.foldW=a.matchW;a.match=a.matchW;a.fold=a.match;var Gs=function(t){return function(e){return a.isNone(e)?t():e.value}};a.getOrElseW=Gs;a.getOrElse=a.getOrElseW;a.flap=xi.flap(a.Functor);a.apFirst=se.apFirst(a.Apply);a.apSecond=se.apSecond(a.Apply);a.flatten=a.compact;a.chainFirst=yi.chainFirst(a.Chain);a.duplicate=a.extend(C.identity);a.fromEitherK=Ii.fromEitherK(a.FromEither);a.chainEitherK=Ii.chainEitherK(a.FromEither,a.Chain);var Qs=function(t){return t==null?a.none:a.some(t)};a.fromNullable=Qs;var Ys=function(t){try{return a.some(t())}catch{return a.none}};a.tryCatch=Ys;var $s=function(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return a.tryCatch(function(){return t.apply(void 0,e)})}};a.tryCatchK=$s;var Js=function(t){return C.flow(t,a.fromNullable)};a.fromNullableK=Js;var Xs=function(t){return function(e){return a.isNone(e)?a.none:a.fromNullable(t(e.value))}};a.chainNullableK=Xs;a.toNullable=a.match(C.constNull,C.identity);a.toUndefined=a.match(C.constUndefined,C.identity);function Si(t){return function(e,r){if(r===void 0){var n=Si(t);return function(u){return n(e,u)}}return a.isNone(r)?!1:t.equals(e,r.value)}}a.elem=Si;var ks=function(t){return function(e){return a.isNone(e)?!1:t(e.value)}};a.exists=ks;a.Do=a.of(dt.emptyRecord);a.bindTo=xi.bindTo(a.Functor);a.bind=yi.bind(a.Chain);a.apS=se.apS(a.Apply);a.ApT=a.of(dt.emptyReadonlyArray);var tm=function(t){return function(e){var r=t(0,dt.head(e));if(a.isNone(r))return a.none;for(var n=[r.value],u=1;u<e.length;u++){var f=t(u,e[u]);if(a.isNone(f))return a.none;n.push(f.value)}return a.some(n)}};a.traverseReadonlyNonEmptyArrayWithIndex=tm;var em=function(t){var e=a.traverseReadonlyNonEmptyArrayWithIndex(t);return function(r){return dt.isNonEmpty(r)?e(r):a.ApT}};a.traverseReadonlyArrayWithIndex=em;a.traverseArrayWithIndex=a.traverseReadonlyArrayWithIndex;var rm=function(t){return a.traverseReadonlyArrayWithIndex(function(e,r){return t(r)})};a.traverseArray=rm;a.sequenceArray=a.traverseArray(C.identity);function nm(t){return function(e){return a.isSome(t(e))}}a.getRefinement=nm;a.mapNullable=a.chainNullableK;a.option={URI:a.URI,map:K,of:a.of,ap:st,chain:me,reduce:he,foldMap:ve,reduceRight:ge,traverse:_r,sequence:a.sequence,zero:a.zero,alt:Vr,extend:Mi,compact:a.compact,separate:a.separate,filter:zt,filterMap:Or,partition:Er,partitionMap:Ur,wither:Fr,wilt:qr,throwError:a.throwError};a.getApplySemigroup=se.getApplySemigroup(a.Apply);a.getApplyMonoid=hs.getApplicativeMonoid(a.Applicative);var im=function(){return a.getMonoid(Ri.first())};a.getFirstMonoid=im;var om=function(){return a.getMonoid(Ri.last())};a.getLastMonoid=om});var un=at(P());function Tr(t,e){t.addEventListener("mousemove",r=>{if(r.buttons!==1)return;let n=.01;e(u=>({...u,longitude:u.longitude+r.movementX*n,latitude:u.latitude+r.movementY*n}))}),t.addEventListener("wheel",r=>{r.preventDefault(),e(n=>({...n,radius:n.radius*(1+r.deltaY*.001)}))})}var $r=at(P());var mt=(t,e)=>[t[0]+e[0],t[1]+e[1],t[2]+e[2]];var X=(t,e)=>[t[0]*e,t[1]*e,t[2]*e],St=(t,e)=>mt(t,X(e,-1)),ki=(t,e)=>X(t,1/e),xe=t=>t.every(e=>e===0);var Bt=t=>Math.hypot(...t);var Dt=t=>xe(t)?[0,0,0]:ki(t,Bt(t)),jr=(t,e)=>Bt(St(t,e)),zr=(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2],Br=(t,e)=>[t[1]*e[2]-e[1]*t[2],t[2]*e[0]-e[2]*t[0],t[0]*e[1]-e[0]*t[1]];var to=[1,0,0,0,1,0,0,0,1],bt=(t,e)=>[t[0]*e[0]+t[3]*e[1]+t[6]*e[2],t[1]*e[0]+t[4]*e[1]+t[7]*e[2],t[2]*e[0]+t[5]*e[1]+t[8]*e[2]],Dr=(t,e)=>[...bt(t,e.slice(0,3)),...bt(t,e.slice(3,6)),...bt(t,e.slice(6,9))],Hr=t=>{let[e,r,n,u,f,l,d,g,y]=t,W=[f*y-l*g,l*d-y*u,g*u-d*f,r*y-n*g,n*d-e*y,g*e-d*r,f*n-l*r,l*e-u*n,r*u-e*f],et=1/(e*W[0]+r*W[1]+n*W[2]),J=1/(u*W[3]+f*W[4]+l*W[5]),rt=1/(d*W[6]+g*W[7]+y*W[8]);return[W[0]*et,W[3]*J,W[6]*rt,W[1]*et,W[4]*J,W[7]*rt,W[2]*et,W[5]*J,W[8]*rt]},eo=(t,e)=>r=>{let n=Dt(Br(t,r)),u=X(t,zr(t,r)),f=Dt(St(r,u)),[l,d]=[Math.sin(e),Math.cos(e)],g=jr(u,r);return mt(u,X(mt(X(n,l),X(f,d)),g))},We=t=>{if(xe(t))return to;let e=Dt(t),r=Bt(t),n=eo(e,r);return[...n([1,0,0]),...n([0,1,0]),...n([0,0,1])]};function Kr(t,e){let[r,n]=[e.width,e.height],u=r/n,f=t.size,l=2*f/(u+1);return{width:l*u,height:l}}var Zr=t=>e=>[e[0]/t.width,e[1]/t.height];function Gr(t,e){let[r,n]=[e.width,e.height],u=r/n,f=Math.tan(t.fieldOfViewDeg/360*Math.PI),l=f/u;return{widthPerZ:f,heightPerZ:l}}var Qr=t=>e=>{let r=e[2];return[e[0]/(t.widthPerZ*r),e[1]/(t.heightPerZ*r)]};function Me(t){return"fieldOfViewDeg"in t}var Yr=(t,e)=>Me(t)?Qr(Gr(t,e)):Zr(Kr(t,e));var ro=t=>e=>{let{canvas:r}=e,{normalizedOffset:n}=t,[u,f]=n,l=t.scale;return d=>{let[g,y]=[r.clientWidth,r.clientHeight];return[g*(u+d[0]*l),y*(f-d[1]*l)]}},Jr=(t,e,r)=>(0,$r.flow)(Yr(e,r.canvas),ro(t)(r)),Xr=t=>e=>bt(t.inverseMatrix,St(e,t.transform.position));function Se(t){let e=window.innerWidth,r=window.innerHeight,n=window.devicePixelRatio||1;Object.assign(t.style,{width:`${e}px`,height:`${r}px`}),Object.assign(t,{width:e*n,height:r*n})}function kr(t,e){window.onresize=()=>{Se(t),e()}}function tn(){return document.body.insertAdjacentHTML("beforeend","<canvas></canvas>"),document.querySelector("canvas")}function no(t){let e=We([0,t.longitude,0]),r=We([t.latitude,0,0]);return Dr(e,r)}function en(t){let e=no(t),r=e.slice(6);return{position:X(r,-t.radius),orientation:e}}var rn={orbitParams:{radius:5,latitude:0,longitude:0},orbitCenter:[0,0,0],projectionSettings:{fieldOfViewDeg:56}};function nn(t){let e=en(t.orbitParams),r={...e,position:mt(e.position,t.orbitCenter)};return{transform:r,inverseMatrix:Hr(r.orientation),projectionSettings:t.projectionSettings}}function on(t){return Me(t.projectionSettings)?t:{...t,projectionSettings:{...t.projectionSettings,size:t.orbitParams.radius}}}function an(t){let e=null;t.canvas?e=t.canvas:(e=tn(),kr(e,()=>d()),Se(e));let r={normalizedOffset:[.5,.5],scale:1},n=t.initialCamera||rn,u=g=>{n=g(n),d()},f=e.getContext("2d"),l=t.backgroundColor||"#d4d3d2",d=()=>{let{canvas:g}=f,[y,W]=[g.width,g.height];f.save(),f.fillStyle=l,f.fillRect(0,0,y,W),Object.assign(f,{strokeStyle:"#3b3a39",lineWidth:2,lineJoin:"round"});let et=nn(n),J=Xr(et),rt=Jr(r,n.projectionSettings,f);t.renderScene({ctx:f,width:y,height:W,camera:et,worldToCam:J,camToCanvas:rt,worldToCanvas:(0,un.flow)(J,rt)}),f.restore()};return Tr(e,g=>{u(y=>on({...y,orbitParams:g(y.orbitParams)})),t.onCamChanged&&t.onCamChanged(n)}),d(),{transformCamera:u,performRender:d}}var cn=(t,e)=>{be(t,e),t.closePath()},be=(t,e)=>{t.beginPath(),t.moveTo(...e[0]),e.slice(1).map(r=>t.lineTo(...r))};function Ae(t,e,r,n){n&&Object.assign(t,n),t.beginPath(),t.arc(e[0],e[1],r,0,Math.PI*2),t.fill()}var _e=(t,e)=>[t[0]+e[0],t[1]+e[1],t[2]+e[2]];var Ve=(t,e)=>[t[0]*e,t[1]*e,t[2]*e],io=(t,e)=>_e(t,Ve(e,-1)),oo=(t,e)=>Ve(t,1/e),uo=t=>t.every(e=>e===0);var Oe=t=>Math.hypot(...t);var pn=t=>uo(t)?[0,0,0]:oo(t,Oe(t));var fn=(t,e,r)=>_e(t,Ve(io(e,t),r)),ln=t=>t.map(Math.round);var Ee=at(P());var dn=t=>`rgb(${ln(t).join(",")})`;function sn(t,e,r){return(r-t)/(e-t)}var co=t=>e=>[e[0],t,e[2]],po=co(0),ah=(0,Ee.flow)(po,pn);var fo=t=>{let e=0,r=0,n=()=>{let u=window.performance.now(),f=(u-r)/1e3;e+=f,r=u,t({dt:f,t:e}),requestAnimationFrame(n)};requestAnimationFrame(n)};var At=(t,e)=>[t[0]+e[0],t[1]+e[1]],Y=(t,e)=>[t[0]*e,t[1]*e],Ht=(t,e)=>At(t,Y(e,-1));var Kt=t=>e=>[t(e[0]),t(e[1])],lh=Kt(Math.round),mn=(t,e)=>[t,e];function lo(t){return{...t,position:Y(t.size,-t.cellSize/2)}}var hn=t=>e=>At(t.position,Y(e,t.cellSize));var H=at(P()),F=at(mi()),Cr=at(Xe()),tt=at(bi()),Ai=(0,H.flow)((0,F.filter)(tt.isSome),(0,F.map)(t=>t.value));function um(t,e){let r=[e[0],e[2]];return(0,H.pipe)(Ht(r,t.position),Kt(n=>Math.round(n/t.cellSize)))}var am=[[-1,-1],[-1,1],[1,-1],[1,1]],cm=t=>e=>[0,1].map(r=>e[r]*t[r]),pm=t=>e=>{let r=(0,H.pipe)([0,1],(0,F.map)((0,H.flow)(u=>Y(t[u],e[u]),(0,F.sort)(Cr.Ord))));if(r[0][1]<1||r[1][1]<1)return tt.none;let n=(0,H.pipe)(r,(0,F.map)(u=>u.map(f=>Math.max(1,f))));return(0,tt.some)({signPattern:e,rect:n})};function fm(t){return(0,H.pipe)(am,(0,F.map)(pm(t)),Ai)}function lm(t){let[e,r]=t.rect[0],[n,u]=t.rect[1],f=[];for(let l=r;l>=e;l--){let d=l+u;for(let g=l;g<=r;g++){let y=d-g;if(y<n)break;f.push([g,y])}}for(let l=u-1;l>=n;l--){let d=e+l;for(let g=e;g<=r;g++){let y=d-g;if(y<n)break;f.push([g,y])}}return f=f.map(cm(t.signPattern)),f}var dm=[[1,0],[-1,0],[0,1],[0,-1]],sm=t=>e=>{let r=e[0]===0?0:1,n=t[r];if(n[0]>0||n[1]<0)return tt.none;let u=(r+1)%2,f=e[u],l=(0,H.pipe)(t[u],(0,F.map)(d=>d*f),(0,F.sort)(Cr.Ord));return l[1]<1?tt.none:(l=Kt(d=>Math.max(1,d))(l),(0,tt.some)({axis:e,range:l}))};function mm(t){return(0,H.pipe)(dm,(0,F.map)(sm(t)),Ai)}function hm(t){return(0,H.pipe)((0,F.range)(t.range[0],t.range[1]),F.reverse,(0,F.map)(e=>Y(t.axis,e)))}function vm(t){return t[0][0]<=0&&t[0][1]>=0&&t[1][0]<=0&&t[1][1]>=0}function _i(t,e){let r=Y(um(e,t),-1),n=[0,1].map(f=>[r[f],r[f]+e.size[f]-1]),u=[...(0,H.pipe)(n,fm,(0,F.map)(lm),F.flatten),...(0,H.pipe)(n,mm,(0,F.map)(hm),F.flatten),...vm(n)?[mn(0,0)]:[]];return(0,F.map)((0,H.flow)(f=>Ht(f,r),hn(e)))(u)}var gm=[[1,1],[-1,1],[1,-1],[-1,-1]],ym=[[0,1,3],[3,2,0]];function Vi(t,e,r,n,u,f){let d=gm.map(g=>{let y=At(u,Y(g,r)),W=n(y);return[y[0],W,y[1]]}).map(e);t.fillStyle=f;for(let g of ym){let y=g.map(W=>d[W]);cn(t,y),t.fill(),be(t,y),t.stroke()}}var Im=t=>e=>{let{ctx:r,gridField:n,shape:u,colorField:f,worldToCam:l,camToScreen:d}=t,g=n.cellSize/2,y=t.scalarField(e),W=f([e[0],y,e[1]]);if(u!=="cube")if(u==="sphere"){let et=[e[0],y,e[1]],J=l(et),rt=Oe(J),wr=d(J),Pr=30/rt;Ae(r,wr,Pr+3,{fillStyle:"black"}),Ae(r,wr,Pr,{fillStyle:W})}else u==="triangle"&&Vi(r,t.worldToScreen,g,t.scalarField,e,W)};function Oi(t){let{gridField:e}=t;_i(t.camPosition,e).forEach(Im(t))}var xm=function(){let t=[100,173,232],e=[232,83,42];return r=>dn(fn(t,e,sn(-1,1,r[1])))}();function Rm(t){let e=t.gridField,r=t.heightMap,n=t.colorField||xm,u=d=>{r=d,l.performRender()},f=d=>{n=d,l.performRender()},l=an({canvas:t.canvas,backgroundColor:"#d4d3d2",initialCamera:{orbitParams:{radius:14,latitude:.4,longitude:.5},orbitCenter:[0,0,0],projectionSettings:{fieldOfViewDeg:56}},renderScene:d=>{Oi({ctx:d.ctx,camToScreen:d.camToCanvas,worldToCam:d.worldToCam,worldToScreen:d.worldToCanvas,camPosition:d.camera.transform.position,shape:t.shape,gridField:e,scalarField:r,colorField:n})}});return{updateHeightMap:u,updateColorField:f,requestRender:l.performRender,transformCamera:l.transformCamera}}export{lo as centerGridField,Rm as setupHeightMapScene,fo as startLoop};
